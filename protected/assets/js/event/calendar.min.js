(function(a,b,c){a.requester={requester_name:"",requester_email:"",requester_phone:""};a.onReady=function(){var d=b(".my-calendar-list");d.on("click",".previous-link, .next-link",function(g){g.preventDefault();var f=b(this).attr("href");b.ajax({url:f,dataType:"html",type:"GET",success:function(i,k,h){var e=b(i);e.hide();var j=d.parent();d.fadeOut(333,function(){d.remove();j.append(e);e.fadeIn(666,function(){d=e})})},error:function(e,i,h){utilities.ajaxError.show("Facility Calendar","Failed to retrieve the calendar",e,i,h)}})});d.on("click",".purchase-request, .information-request",function(j){j.preventDefault();var h=b(this).attr("href");var i=b(this);var g="";if(i.hasClass("purchase-request")){g="Reservation Request"}else{g="Information Request"}var f=utilities.modal.add(g,a.buildRequestModalForm(),false,false,false);f.modal({loading:false,replace:false,modalOverflow:false});b("#requesterPhone").val(a.requester.requester_phone);b("#requesterName").val(a.requester.requester_name);b("#requesterEmail").val(a.requester.requester_email);b("#requesterPhone").inputmask({mask:"(999) 999-9999",autoUnmask:true,showTooltip:true,clearIncomplete:true});b("button[type=submit]").attr("disabled","disabled");b("input").off("keyup");b("input").on("keyup",function(){var e=a.getRequestInputs();if(e===false){if(b("button[type=submit]").attr("disabled")!=="disabled"){b("button[type=submit]").attr("disabled","disabled")}return}b("button[type=submit]").removeAttr("disabled")});b("#requestModalForm").off("submit");b("#requestModalForm").on("submit",function(m){m.preventDefault();var o=a.getRequestInputs();if(o===false){alert("Your full name, valid e-mail address, and ten digit phone number are required to submit this request");return false}o.notes=moment().format("MM/DD/YYYY h:mm:ss A")+" by "+o.requester_name+":\r\n\r\n"+o.notes+"\r\n\r\n";var n='<div id="loading"><img src="'+utilities.urls.base+'/images/spinners/ajax-loader.gif" alt="Loading..." /></div>';var l=b(n);var k=f.find("button");k.attr("disabled","disabled");b(this).append(l);b.ajax({url:h,type:"POST",data:o,success:function(e){l.remove();k.removeAttr("disabled");b("#requestModalForm").fadeOut(250,function(){var q=f.find(".modal-body");var p=b('<h1 class="text-success">You request has been sent!</h1><p>Please besure to follow-up with the facility.</p>');p.hide();q.append(p);p.fadeIn(250)})},error:function(e,q,p){l.remove();k.removeAttr("disabled");utilities.ajaxError.show("Event Request","Failed to send the request. Please try again later.",e,q,p)}})});f.show();b("input").trigger("keyup")})};a.buildRequestModalForm=function(){var d='<form id="requestModalForm" class="well"><div class="row-fluid"><div><label>Full Name</label><input id="requesterName" name="requester_name" class="span12" placeholder="Your full name" type="text" /><label>Email Address</label><input id="requesterEmail" name="requester_email" class="span12" placeholder="Your email address" type="text" /> <label>Phone Number</label><input id="requesterPhone" name="requester_phone" class="span12" placeholder="Your ten digit phone number" type="text" /><label>Message</label><textarea id="Notes" name="notes" rows="6" class="span12" placeholder="Enter a message"></textarea></div><button class="btn btn-primary pull-right" type="submit"><i class="fa fa-fw fa-upload"></i> <span>Send</span></button></div></form>';return d};a.getRequestInputs=function(){var f=b("#requestModalForm :input");var g=this;var e={};var d=0;f.each(function(){if(this.name!==""&&b(this).val()!==null&&b(this).val()!==""){if(typeof b(this).val()==="string"){var i=b(this).val();if(typeof i.trim==="function"){i=i.trim()}if(this.name==="requester_phone"){i=b(this).inputmask("unmaskedvalue");if(i.length!==10){return false}e[this.name]=i;d++}else{if(this.name==="requester_email"){var h=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;if(h.test(i)){e[this.name]=i;d++}else{return false}}else{if(this.name==="requester_name"){if(i.length<=2){return false}e[this.name]=i;d++}else{e[this.name]=i}}}}}});if(d!==3){return false}return e}}(window.eventCalendar=window.eventCalendar||{},jQuery));