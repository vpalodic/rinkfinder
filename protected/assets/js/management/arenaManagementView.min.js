(function(c,a,b){c.endpoints={arena:{viewRecord:"/server/endpoint",updateRecord:"/server/endpoint",newRecord:"/server/endpoint"},location:{viewRecord:"/server/endpoint",updateRecord:"/server/endpoint",newRecord:"/server/endpoint",deleteRecord:"/server/endpoint"},contact:{viewRecord:"/server/endpoint",updateRecord:"/server/endpoint",newRecord:"/server/endpoint",deleteRecord:"/server/endpoint"},event:{viewRecord:"/server/endpoint",updateRecord:"/server/endpoint",newRecord:"/server/endpoint",deleteRecord:"/server/endpoint",searchRecord:"/server/endpoint",exportRecord:"/server/endpoint",deleteAllRecord:"/server/endpoint"},manager:{viewRecord:"/server/endpoint",updateRecord:"/server/endpoint",newRecord:"/server/endpoint",deleteRecord:"/server/endpoint"}};c.arena={};c.locations={};c.locationTypes=[];c.locationStatuses=[];c.contacts={};c.events={};c.eventTypes=[];c.eventStatuses=[];c.newEventRecord=false;c.managers={};c.params={};c.isArenaManager=false;c.statusList=[];c.stateList=[];c.attribute={name:"",oldVal:"",newVal:""};c.Id=0;c.Name="";c.onReady=function(){if(typeof a.fn.editable==="undefined"){c.loadEditable()}else{c.enableEditable()}var d=a("#arenaManagementView.panel.panel-primary");if(d.length>0){d.on("destroyed",function(){var e=a("#arenaManagementView.panel.panel-primary .editable");e.editable("destroy")})}c.setupArenaGeocoding();c.setupInitialContactView();c.setupInitialLocationView();c.setupInitialEventView();if(c.isArenaManager){c.setupInitialManagerView()}a('[data-toggle="tooltip"]').tooltip()};c.loadEditable=function(){var e=utilities.debug?"bootstrap-editable.js":"bootstrap-editable.min.js";a.ajax({url:utilities.urls.assets+(utilities.debug?"/bootstrap-editable/js/bootstrap-editable.js":"/bootstrap-editable/js/bootstrap-editable.min.js"),dataType:"script",cache:true,success:function(){console.log("Loaded: "+e)},error:function(h,f,g){utilities.ajaxError.show("Error","Failed to retrieve javsScript file",h,f,g)}});var d=setInterval(function(){if(typeof typeof a.fn.editable!=="undefined"){clearInterval(d);c.enableEditable()}else{if(console&&console.log){console.log("Loading... "+e)}}},500)};c.enableEditable=function(){c.setupArenaName();c.setupArenaLogo();c.setupArenaUrl();c.setupArenaExternalId();c.setupArenaTags();c.setupArenaStatus();c.setupArenaAddressLine1();c.setupArenaAddressLine2();c.setupArenaCity();c.setupArenaState();c.setupArenaZip();c.setupArenaPhone();c.setupArenaExtension();c.setupArenaFax();c.setupArenaFaxExtension();c.setupArenaDescription();c.setupArenaNotes()};c.setupArenaName=function(){a("#Arena_name").editable({params:c.params})};c.setupArenaLogo=function(){a("#Arena_logo").editable({params:c.params,success:function(d,g){if(d&&d.length>0){return"Data not saved. Please refresh the page as it appears the session has expired."}var e=a("#Arena_logo_img");var f=e.parent();var h=a('<img id="Arena_logo_img" class="img-circle" src="'+g+'" alt="Facility Logo" />');e.remove();f.append(h);e=h}})};c.setupArenaUrl=function(){a("#Arena_url").editable({params:c.params})};c.setupArenaExternalId=function(){a("#Arena_external_id").editable({params:c.params})};c.setupArenaTags=function(){a("#Arena_tags").editable({params:c.params})};c.setupArenaStatus=function(){if(c.isArenaManager!==1){return}a("#Arena_status_id").editable({params:c.params,showbuttons:false,source:c.statusList})};c.setupArenaAddressLine1=function(){a("#Arena_address_line1").editable({params:c.params})};c.setupArenaAddressLine2=function(){a("#Arena_address_line2").editable({params:c.params})};c.setupArenaCity=function(){a("#Arena_city").editable({params:c.params})};c.setupArenaState=function(){a("#Arena_state").editable({params:c.params,showbuttons:false,source:c.stateList})};c.setupArenaZip=function(){a("#Arena_zip").editable({params:c.params})};c.setupArenaGeocoding=function(){a("#Arena_geocode_btn").on("click",function(g){g.preventDefault();var d="";var h='<div id="loading"><img src="'+utilities.urls.base+'/images/spinners/ajax-loader.gif" alt="Loading..." /></div>';var f=a("#Arena_geocode_btn").parent();f.append(h);a("#Arena_geocode_btn").hide(300,function(){var n=new google.maps.Geocoder();var k=a("#Arena_address_line1, #Arena_address_line2, #Arena_city, #Arena_state, #Arena_zip").editable("getValue");var m=k.address_line1;var j=k.address_line2;var o=k.city;var l=k.state;var i=k.zip;if(typeof m.trim==="function"){m=m.trim();j=j.trim();o=o.trim();l=l.trim();i=String(i).trim()}var e="";if(j.length>0){e=m+", "+j+", "+o+", "+l+" "+i}else{e=m+", "+o+", "+l+" "+i}if(d!==e){n.geocode({address:e},function(s,q){if(q===google.maps.GeocoderStatus.OK){var r=s[0].geometry.location;d=e;var p=c.params;p.name="geocoding";p.value=[r.lat(),r.lng()];p.pk=p.id;p.lat=r.lat();p.lng=r.lng();a.ajax({url:c.endpoints.arena.updateRecord,data:p,type:"POST",dataType:"html",success:function(t,u,w){var x=false;try{x=JSON.parse(t)}catch(v){x=false}if(x!==false){a("#Arena_geocode_btn").show(300,function(){f.find("#loading").remove()});utilities.ajaxError.show("Error","Failed to assign the contact",w,"error","Login Required");return}a("#Arena_geocode_btn").show(300,function(){var A=a("#Arena_directions");var z="http://maps.google.com/maps?daddr="+escape(e);A.attr("href",z);f.find("#loading").remove();var y='<div class="alert alert-success"><button type="button" class="close" data-dismiss="alert">&times;</button><strong>Success!</strong></div>';f.prepend(y)})},error:function(v,t,u){a("#Arena_geocode_btn").show(300,function(){f.find("#loading").remove()});utilities.ajaxError.show("Error","Failed to update the lattitude and longitude",v,t,u)}})}else{a("#Arena_geocode_btn").show(300,function(){f.find("#loading").remove();var t='<div class="alert alert-error"><button type="button" class="close" data-dismiss="alert">&times;</button><strong>Error!</strong> '+e+" not found</div>";f.append(t)})}})}})})};c.setupArenaPhone=function(){a("#Arena_phone").editable({params:c.params,display:function(f,e){var d="";if(typeof f==="undefined"||f.length<=0){return}d=String(f).replace(/\D/g,"").replace(/(\d{3})(\d{3})(\d{4})/,"($1) $2-$3");a(this).html(d)}});a("#Arena_phone").on("shown",function(f,d){if(d){a(this).data("editable").input.$input.inputmask({mask:"(999) 999-9999",clearIncomplete:false,autoUnmask:true,showTooltip:true})}})};c.setupArenaExtension=function(){a("#Arena_ext").editable({params:c.params})};c.setupArenaFax=function(){a("#Arena_fax").editable({params:c.params,display:function(f,e){var d="";if(typeof f==="undefined"||f.length<=0){return}d=String(f).replace(/\D/g,"").replace(/(\d{3})(\d{3})(\d{4})/,"($1) $2-$3");a(this).html(d)}});a("#Arena_fax").on("shown",function(f,d){if(d){a(this).data("editable").input.$input.inputmask({mask:"(999) 999-9999",clearIncomplete:false,autoUnmask:true,showTooltip:true})}})};c.setupArenaFaxExtension=function(){a("#Arena_fax_ext").editable({params:c.params})};c.setupArenaDescription=function(){a("#Arena_description").editable({params:c.params});a("#Arena_description_edit").on("click",function(d){d.stopPropagation();d.preventDefault();a("#Arena_description").editable("toggle")})};c.setupArenaNotes=function(){a("#Arena_notes").editable({params:c.params});a("#Arena_notes_edit").on("click",function(d){d.stopPropagation();d.preventDefault();a("#Arena_notes").editable("toggle")})};c.setupInitialContactView=function(){var j=this;var f=a("#assignContactButton");var m=a("#unassignContactButton");var l=a("#newContactButton");var e=a("#deleteContactButton");var g=a("#saveContactButton");var h=a("#cancelContactButton");var d=a("#availableContactsMSelect");var i=a("#assignedContactsMSelect");var k=a("#assignedContactsSelect");f.attr("disabled","disabled");m.attr("disabled","disabled");e.attr("disabled","disabled");g.attr("disabled","disabled").hide();h.attr("disabled","disabled").hide();d.on("change",function(o){var n=d.find("option:selected");if(n.length>0){f.removeAttr("disabled")}else{f.attr("disabled","disabled")}});i.on("change",function(o){var n=i.find("option:selected");if(n.length>0){m.removeAttr("disabled")}else{m.attr("disabled","disabled")}});k.on("change",function(p){var n=k.find("option:selected");if(n.length>0){var o=a(this).val();j.resetContactView();if(o=="none"){return}j.loadContact(o)}else{j.resetContactView()}});f.on("click",function(q){q.preventDefault();var r='<div id="loading"><img src="'+utilities.urls.base+'/images/spinners/ajax-loader.gif" alt="Loading..." /></div>';var p=d.find("option:selected");var o=[];p.each(function(){o.push(a(this).val())});if(o.length<=0){return}f.attr("disabled","disabled");m.attr("disabled","disabled");d.attr("disabled","disabled");i.attr("disabled","disabled");f.parent().prepend(r);var n={name:"assign",value:o,aid:c.params.id,id:1,pk:1,output:"html"};a.ajax({url:c.endpoints.contact.updateRecord,data:n,type:"POST",dataType:"html",success:function(s,t,v){var w=false;try{w=JSON.parse(s)}catch(u){w=false}if(w!==false){window.setTimeout(function(){d.removeAttr("disabled");i.removeAttr("disabled");f.removeAttr("disabled");f.parent().find("#loading").remove();utilities.ajaxError.show("Error","Failed to assign the contact",v,"error","Login Required")},1000);return}p.each(function(){i.append('<option value="'+a(this).val()+'">'+a(this).text()+"</option>");k.append('<option value="'+a(this).val()+'">'+a(this).text()+"</option>");a(this).remove()});d.val("");i.val("");d.removeAttr("disabled");i.removeAttr("disabled");f.parent().find("#loading").remove()},error:function(u,s,t){d.removeAttr("disabled");i.removeAttr("disabled");f.removeAttr("disabled");f.parent().find("#loading").remove();utilities.ajaxError.show("Error","Failed to assign the contacts",u,s,t)}})});m.on("click",function(q){q.preventDefault();var r='<div id="loading"><img src="'+utilities.urls.base+'/images/spinners/ajax-loader.gif" alt="Loading..." /></div>';var p=i.find("option:selected");var o=[];p.each(function(){o.push(a(this).val())});if(o.length<=0){return}f.attr("disabled","disabled");m.attr("disabled","disabled");d.attr("disabled","disabled");i.attr("disabled","disabled");m.parent().prepend(r);var n={name:"unassign",value:o,aid:c.params.id,id:1,pk:1,output:"html"};a.ajax({url:c.endpoints.contact.updateRecord,data:n,type:"POST",dataType:"html",success:function(s,t,v){var w=false;try{w=JSON.parse(s)}catch(u){w=false}if(w!==false){window.setTimeout(function(){d.removeAttr("disabled");i.removeAttr("disabled");m.removeAttr("disabled");m.parent().find("#loading").remove();utilities.ajaxError.show("Error","Failed to unassign the contact",v,"error","Login Required")},1000);return}p.each(function(){d.append('<option value="'+a(this).val()+'">'+a(this).text()+"</option>");var x=k.find('option[value="'+a(this).val()+'"]');if(k.val()==x.val()){k.val("none");x.remove();k.trigger("change")}else{x.remove()}a(this).remove()});d.val("");i.val("");d.removeAttr("disabled");i.removeAttr("disabled");m.parent().find("#loading").remove()},error:function(u,s,t){d.removeAttr("disabled");i.removeAttr("disabled");m.removeAttr("disabled");m.parent().find("#loading").remove();utilities.ajaxError.show("Error","Failed to unassign the contacts",u,s,t)}})});l.on("click",function(o){o.preventDefault();k.attr("disabled","disabled");k.val("none");var n={aid:c.params.aid,output:"html"};c.setupNewContactView(n);l.attr("disabled","disabled");e.attr("disabled","disabled")});e.on("click",function(o){o.preventDefault();var n=c.createDeleteModal();n.modal({loading:false,replace:false,modalOverflow:false});a("button#yes").off("click");a("button#yes").on("click",function(r){var q=k.val();var s='<div id="loading"><img src="'+utilities.urls.base+'/images/spinners/ajax-loader.gif" alt="Loading..." /></div>';f.attr("disabled","disabled");m.attr("disabled","disabled");d.attr("disabled","disabled");i.attr("disabled","disabled");k.attr("disabled","disabled");l.attr("disabled","disabled");e.attr("disabled","disabled");g.attr("disabled","disabled").hide();h.attr("disabled","disabled").hide();e.parent().prepend(s);var p={aid:c.params.id,id:q,pk:q,output:"html"};a.ajax({url:c.endpoints.contact.deleteRecord,data:p,type:"POST",dataType:"html",success:function(t,u,w){a("button#yes").off("click");var x=false;try{x=JSON.parse(t)}catch(v){x=false}if(x!==false){window.setTimeout(function(){d.val("");i.val("");d.removeAttr("disabled");i.removeAttr("disabled");k.removeAttr("disabled");l.removeAttr("disabled");e.parent().find("#loading").remove();utilities.ajaxError.show("Error","Failed to delete the contact",w,"error","Login Required")},1000);return}i.find('option[value="'+q+'"]').remove();k.find('option[value="'+q+'"]').remove();k.val("none").trigger("change");d.val("");i.val("");d.removeAttr("disabled");i.removeAttr("disabled");k.removeAttr("disabled");l.removeAttr("disabled");e.parent().find("#loading").remove()},error:function(v,t,u){a("button#yes").off("click");d.val("");i.val("");d.removeAttr("disabled");i.removeAttr("disabled");k.removeAttr("disabled");l.removeAttr("disabled");e.parent().find("#loading").remove();utilities.ajaxError.show("Error","Failed to delete the contact",v,t,u)}})})});g.on("click",function(n){n.preventDefault();var o='<div id="loading"><img src="'+utilities.urls.base+'/images/spinners/ajax-loader.gif" alt="Loading..." /></div>';f.attr("disabled","disabled");m.attr("disabled","disabled");d.attr("disabled","disabled");i.attr("disabled","disabled");k.attr("disabled","disabled");l.attr("disabled","disabled");e.attr("disabled","disabled");g.attr("disabled","disabled");h.attr("disabled","disabled");g.parent().prepend(o);a(".contact-editable").editable("submit",{url:c.endpoints.contact.newRecord,ajaxOptions:{dataType:"json"},success:function(u,q){d.removeAttr("disabled");i.removeAttr("disabled");if(d.val()>0){f.removeAttr("disabled")}if(i.val()>0){m.removeAttr("disabled")}g.removeAttr("disabled");h.removeAttr("disabled");g.parent().find("#loading").remove();if(u&&u.id){a(this).editable("option","pk",u.id);a(this).removeClass("editable-unsaved");var t=a("#Contact_active, #Contact_last_name, #Contact_first_name, #Contact_email").editable("getValue");var v=(t.active==0)?"Inactive":"Active";var s=t.last_name+", "+t.first_name+" - "+t.email+" ("+v+")";var r='<option value="'+u.id+'">'+s+"</option>";k.append(r);i.append(r);k.val(u.id);g.attr("disabled","disabled").hide(250);h.attr("disabled","disabled").hide(250);k.removeAttr("disabled");l.removeAttr("disabled");e.removeAttr("disabled");var p='<div class="alert alert-success"><button type="button" class="close" data-dismiss="alert">&times;</button><h3><span class="badge badge-success">New contact added!</span></h3></div>';a("#contactDetails").prepend(p)}else{if(u&&u.errors){q.error.call(this,u.errors)}else{if(u&&u.error){q.error.call(this,u.error)}}}},error:function(s){d.removeAttr("disabled");i.removeAttr("disabled");if(d.val()>0){f.removeAttr("disabled")}if(i.val()>0){m.removeAttr("disabled")}g.removeAttr("disabled");h.removeAttr("disabled");g.parent().find("#loading").remove();var r="";if(s&&s.responseText){r=s.responseText;utilities.ajaxError.show("Error","Failed to add the new contact",s,"error","Unknown")}else{try{if(s){s=JSON.parse(s)}a.each(s,function(u,t){r+=t+"<br>"})}catch(q){s=false}}var p='<div class="alert alert-error"><button type="button" class="close" data-dismiss="alert">&times;</button><h3><span class="badge badge-important">Please correct the following errors:</span></h3>'+r+"</div>";a("#contactDetails").prepend(p)}})});h.on("click",function(n){n.preventDefault();c.resetContactView()})};c.setupContactEditables=function(d){a("#Contact_first_name").editable({params:d,success:function(h,f){if(h&&h.length>0){return"Data not saved. Please refresh the page as it appears the session has expired."}var n=a("#Contact_active, #Contact_last_name, #Contact_email").editable("getValue");var j=a("#assignedContactsMSelect");var l=a("#assignedContactsSelect");var e=l.val();if(e=="none"){return}var m=l.find('option[value="'+e+'"]');var k=j.find('option[value="'+e+'"]');var g=(n.active==0)?"Inactive":"Active";var i=n.last_name+", "+f+" - "+n.email+" ("+g+")";m.text(i);k.text(i)}});a("#Contact_last_name").editable({params:d,success:function(h,f){if(h&&h.length>0){return"Data not saved. Please refresh the page as it appears the session has expired."}var n=a("#Contact_active, #Contact_first_name, #Contact_email").editable("getValue");var j=a("#assignedContactsMSelect");var l=a("#assignedContactsSelect");var e=l.val();if(e=="none"){return}var m=l.find('option[value="'+e+'"]');var k=j.find('option[value="'+e+'"]');var g=(n.active==0)?"Inactive":"Active";var i=f+", "+n.first_name+" - "+n.email+" ("+g+")";m.text(i);k.text(i)}});a("#Contact_active").editable({params:d,showbuttons:false,source:[{value:0,text:"Inactive"},{value:1,text:"Active"}],success:function(h,f){if(h&&h.length>0){return"Data not saved. Please refresh the page as it appears the session has expired."}var n=a("#Contact_first_name, #Contact_last_name, #Contact_email").editable("getValue");var j=a("#assignedContactsMSelect");var l=a("#assignedContactsSelect");var e=l.val();if(e=="none"){return}var m=l.find('option[value="'+e+'"]');var k=j.find('option[value="'+e+'"]');var g=(f==0)?"Inactive":"Active";var i=n.last_name+", "+n.first_name+" - "+n.email+" ("+g+")";m.text(i);k.text(i)}});a("#Contact_primary_contact").editable({params:d,showbuttons:false,source:[{value:0,text:"No"},{value:1,text:"Yes"}]});a("#Contact_email").editable({params:d,success:function(h,f){if(h&&h.length>0){return"Data not saved. Please refresh the page as it appears the session has expired."}var n=a("#Contact_active, #Contact_first_name, #Contact_last_name").editable("getValue");var j=a("#assignedContactsMSelect");var l=a("#assignedContactsSelect");var e=l.val();if(e=="none"){return}var m=l.find('option[value="'+e+'"]');var k=j.find('option[value="'+e+'"]');var g=(n.active==0)?"Inactive":"Active";var i=n.last_name+", "+n.first_name+" - "+f+" ("+g+")";m.text(i);k.text(i)}});a("#Contact_phone").editable({params:d,display:function(g,f){var e="";if(typeof g==="undefined"||g.length<=0){return}e=String(g).replace(/\D/g,"").replace(/(\d{3})(\d{3})(\d{4})/,"($1) $2-$3");a(this).html(e)}});a("#Contact_phone").on("shown",function(g,f){if(f){a(this).data("editable").input.$input.inputmask({mask:"(999) 999-9999",clearIncomplete:false,autoUnmask:true,showTooltip:true})}});a("#Contact_ext").editable({params:d});a("#Contact_fax").editable({params:d,display:function(g,f){var e="";if(typeof g==="undefined"||g.length<=0){return}e=String(g).replace(/\D/g,"").replace(/(\d{3})(\d{3})(\d{4})/,"($1) $2-$3");a(this).html(e)}});a("#Contact_fax").on("shown",function(g,f){if(f){a(this).data("editable").input.$input.inputmask({mask:"(999) 999-9999",clearIncomplete:false,autoUnmask:true,showTooltip:true})}});a("#Contact_fax_ext").editable({params:d})};c.setupContactView=function(d,i){var f=a("#contactDetails");var g=a(".contact-editable");a("#Contact_phone").off("shown");a("#Contact_fax").off("shown");if(g.length>0){g.each(function(){a(this).editable("destroy")})}var h='<strong>Details</strong><br /><table class="table table-condensed table-information"><tbody>';h+='<tr><td style="width:33%">First Name</td><td><a href="#" id="Contact_first_name" data-name="first_name" data-type="text" data-mode="inline" data-url="'+c.endpoints.contact.updateRecord+'" data-pk="'+d.id+'" data-value="'+d.first_name+'" title="First Name" class="contact-editable">'+d.first_name+"</a></td></tr>";h+='<tr><td style="width:33%">Last Name</td><td><a href="#" id="Contact_last_name" data-name="last_name" data-type="text" data-mode="inline" data-url="'+c.endpoints.contact.updateRecord+'" data-pk="'+d.id+'" data-value="'+d.last_name+'" title="Last Name" class="contact-editable">'+d.last_name+"</a></td></tr>";h+='<tr><td style="width:33%">Active</td><td><a href="#" id="Contact_active" data-name="active" data-type="select" data-mode="inline" data-url="'+c.endpoints.contact.updateRecord+'" data-pk="'+d.id+'" data-value="'+d.active+'" title="Contact Status" class="contact-editable">';if(d.active==1){h+="Active</a></td></tr>"}else{h+="Inactive</a></td></tr>"}h+='<tr><td style="width:33%">Primary</td><td><a href="#" id="Contact_primary_contact" data-name="primary_contact" data-type="select" data-mode="inline" data-url="'+c.endpoints.contact.updateRecord+'" data-pk="'+d.id+'" data-value="'+d.primary_contact+'" title="Primary Status" class="contact-editable">';if(d.primary_contact==1){h+="Yes</a></td></tr>"}else{h+="No</a></td></tr>"}h+="</tbody></table>";h+='<strong>Email & Phone</strong><br /><table class="table table-condensed table-information"><tbody>';h+='<tr><td style="width:33%">E-mail</td><td><a href="#" id="Contact_email" data-name="email" data-type="text" data-mode="inline" data-url="'+c.endpoints.contact.updateRecord+'" data-pk="'+d.id+'" data-value="'+d.email+'" title="E-mail Address" class="contact-editable">'+d.email+"</a></td></tr>";h+='<tr><td style="width:33%">Phone</td><td><a href="#" id="Contact_phone" data-name="phone" data-type="text" data-mode="inline" data-url="'+c.endpoints.contact.updateRecord+'" data-pk="'+d.id+'" data-value="'+d.phone+'" title="Ten digit phone number" class="contact-editable">'+d.phone+"</a></td></tr>";h+='<tr><td style="width:33%">Extension</td><td><a href="#" id="Contact_ext" data-name="ext" data-type="text" data-mode="inline" data-url="'+c.endpoints.contact.updateRecord+'" data-pk="'+d.id+'" data-value="'+(d.ext?d.ext:"")+'" title="Phone extension" class="contact-editable">'+(d.ext?d.ext:"")+"</a></td></tr>";h+='<tr><td style="width:33%">Fax</td><td><a href="#" id="Contact_fax" data-name="fax" data-type="text" data-mode="inline" data-url="'+c.endpoints.contact.updateRecord+'" data-pk="'+d.id+'" data-value="'+(d.fax?d.fax:"")+'" title="Ten digit fax number" class="contact-editable">'+(d.fax?d.fax:"")+"</a></td></tr>";h+='<tr><td style="width:33%">Fax Extension</td><td><a href="#" id="Contact_fax_ext" data-name="fax_ext" data-type="text" data-mode="inline" data-url="'+c.endpoints.contact.updateRecord+'" data-pk="'+d.id+'" data-value="'+(d.fax_ext?d.fax_ext:"")+'" title="Fax extension" class="contact-editable">'+(d.fax_ext?d.fax_ext:"")+"</a></td></tr></tbody></table>";var e=a('<div id="contactDetails">'+h+"</div>");e.hide();f.fadeOut(500,function(){f.parent().prepend(e);c.setupContactEditables(i);e.fadeIn(500,function(){var k=a("#assignContactButton");var m=a("#unassignContactButton");var j=a("#newContactButton");var n=a("#deleteContactButton");var o=a("#availableContactsMSelect");var l=a("#assignedContactsMSelect");var p=a("#assignedContactsSelect");o.removeAttr("disabled");l.removeAttr("disabled");p.removeAttr("disabled");j.removeAttr("disabled");n.removeAttr("disabled");if(o.val()>0){k.removeAttr("disabled")}if(l.val()>0){m.removeAttr("disabled")}p.parent().find("#loading").remove();f.remove()})})};c.setupNewContactView=function(h){var e=a("#contactDetails");var f=a(".contact-editable");a("#Contact_phone").off("shown");a("#Contact_fax").off("shown");if(f.length>0){f.each(function(){a(this).editable("destroy")})}var g='<strong>Details</strong><br /><table class="table table-condensed table-information"><tbody>';g+='<tr><td style="width:33%">First Name</td><td><a href="#" id="Contact_first_name" data-name="first_name" data-type="text" data-mode="inline" data-url="'+c.endpoints.contact.updateRecord+'" title="First Name" class="contact-editable"></a></td></tr>';g+='<tr><td style="width:33%">Last Name</td><td><a href="#" id="Contact_last_name" data-name="last_name" data-type="text" data-mode="inline" data-url="'+c.endpoints.contact.updateRecord+'" title="Last Name" class="contact-editable"></a></td></tr>';g+='<tr><td style="width:33%">Active</td><td><a href="#" id="Contact_active" data-name="active" data-type="select" data-mode="inline" data-url="'+c.endpoints.contact.updateRecord+'" data-value="1"title="Contact Status" class="contact-editable">Active</a></td></tr>';g+='<tr><td style="width:33%">Primary</td><td><a href="#" id="Contact_primary_contact" data-name="primary_contact" data-type="select" data-mode="inline" data-url="'+c.endpoints.contact.updateRecord+'" data-value="0"title="Primary Status" class="contact-editable">No</a></td></tr>';g+="</tbody></table>";g+='<strong>Email & Phone</strong><br /><table class="table table-condensed table-information"><tbody>';g+='<tr><td style="width:33%">E-mail</td><td><a href="#" id="Contact_email" data-name="email" data-type="text" data-mode="inline" data-url="'+c.endpoints.contact.updateRecord+'" title="E-mail Address" class="contact-editable"></a></td></tr>';g+='<tr><td style="width:33%">Phone</td><td><a href="#" id="Contact_phone" data-name="phone" data-type="text" data-mode="inline" data-url="'+c.endpoints.contact.updateRecord+'" title="Ten digit phone number" class="contact-editable"></a></td></tr>';g+='<tr><td style="width:33%">Extension</td><td><a href="#" id="Contact_ext" data-name="ext" data-type="text" data-mode="inline" data-url="'+c.endpoints.contact.updateRecord+'" title="Phone extension" class="contact-editable"></a></td></tr>';g+='<tr><td style="width:33%">Fax</td><td><a href="#" id="Contact_fax" data-name="fax" data-type="text" data-mode="inline" data-url="'+c.endpoints.contact.updateRecord+'" title="Ten digit fax number" class="contact-editable"></a></td></tr>';g+='<tr><td style="width:33%">Fax Extension</td><td><a href="#" id="Contact_fax_ext" data-name="fax_ext" data-type="text" data-mode="inline" data-url="'+c.endpoints.contact.updateRecord+'" title="Fax extension" class="contact-editable"></a></td></tr>';g+='<tr style="display:none;"><td>Arena ID</td><td><a href="#" id="Contact_arena_id" data-name="aid" data-type="text" data-mode="inline" data-url="'+c.endpoints.contact.updateRecord+'" data-value="'+c.params.aid+'" title="Arena ID" class="contact-editable">'+c.params.aid+"</a></td></tr>";g+='<tr style="display:none;"><td>Output</td><td><a href="#" id="Contact_output" data-name="output" data-type="text" data-mode="inline" data-url="'+c.endpoints.contact.updateRecord+'" data-value="json" title="Output" class="contact-editable">json</a></td></tr>';g+="</tbody></table>";var d=a('<div id="contactDetails">'+g+"</div>");d.hide();e.fadeOut(500,function(){e.parent().prepend(d);c.setupContactEditables(h);a("#Contact_arena_id").editable({params:h});a("#Contact_output").editable({params:h});d.fadeIn(500,function(){var i=a("#assignContactButton");var l=a("#unassignContactButton");var m=a("#saveContactButton");var j=a("#cancelContactButton");var n=a("#availableContactsMSelect");var k=a("#assignedContactsMSelect");n.removeAttr("disabled");k.removeAttr("disabled");m.removeAttr("disabled").show(250);j.removeAttr("disabled").show(250);if(n.val()>0){i.removeAttr("disabled")}if(k.val()>0){l.removeAttr("disabled")}e.remove()})})};c.resetContactView=function(){var f=a("#contactDetails");var h=a(".contact-editable");var d=a("#newContactButton");var g=a("#deleteContactButton");var i=a("#saveContactButton");var e=a("#cancelContactButton");var j=a("#assignedContactsSelect");d.attr("disabled","disabled");g.attr("disabled","disabled");i.attr("disabled","disabled").hide();e.attr("disabled","disabled").hide();a("#Contact_phone").off("shown");a("#Contact_fax").off("shown");if(h.length>0){h.each(function(){a(this).editable("destroy")})}f.fadeOut(500,function(){f.empty();f.fadeIn(500,function(){d.removeAttr("disabled");j.removeAttr("disabled")})})};c.loadContact=function(f){var g=a("#assignContactButton");var n=a("#unassignContactButton");var m=a("#newContactButton");var e=a("#deleteContactButton");var h=a("#saveContactButton");var i=a("#cancelContactButton");var d=a("#availableContactsMSelect");var k=a("#assignedContactsMSelect");var l=a("#assignedContactsSelect");var o='<div id="loading"><img src="'+utilities.urls.base+'/images/spinners/ajax-loader.gif" alt="Loading..." /></div>';g.attr("disabled","disabled");n.attr("disabled","disabled");m.attr("disabled","disabled");e.attr("disabled","disabled");h.attr("disabled","disabled").hide();i.attr("disabled","disabled").hide();d.attr("disabled","disabled");k.attr("disabled","disabled");l.attr("disabled","disabled");l.parent().append(o);var j={id:f,aid:c.params.aid,output:"json"};a.ajax({url:c.endpoints.contact.viewRecord,data:j,type:"GET",dataType:"json",success:function(p,q,r){if(p.error&&p.error==="LOGIN_REQUIRED"){window.setTimeout(function(){d.removeAttr("disabled");k.removeAttr("disabled");l.removeAttr("disabled");m.removeAttr("disabled");e.removeAttr("disabled");if(d.val()>0){g.removeAttr("disabled")}if(k.val()>0){n.removeAttr("disabled")}l.parent().find("#loading").remove();utilities.ajaxError.show("Error","Failed to load the contact",r,"error","Login Required")},1000);return}j.output="html";if(p.data&&p.data.id!=="undefined"){c.setupContactView(p.data,j)}},error:function(r,p,q){d.removeAttr("disabled");k.removeAttr("disabled");l.removeAttr("disabled");m.removeAttr("disabled");e.removeAttr("disabled");if(d.val()>0){g.removeAttr("disabled")}if(k.val()>0){n.removeAttr("disabled")}l.parent().find("#loading").remove();utilities.ajaxError.show("Error","Failed to load the contact",r,p,q)}})};c.createDeleteModal=function(){var e='<div id="deleteModal" class="well"><h3>Are you sure you want to permanently delete this item?</h3><p class="lead text-error">This operation cannot be undone and will also delete this item from any related items. For example, deleting a location / venue will also delete any events associated with that location / venue.</p></div>';var d='<button class="btn btn-large btn-danger" data-dismiss="modal" type="button" aria-hidden="true" id="yes"><i class="fa fa-fw fa-lg fa-check"></i> Yes</button><button class="btn btn-large" data-dismiss="modal" type="button" aria-hidden="true" id="close"><i class="fa fa-fw fa-lg fa-times"></i> No</button>';return utilities.modal.add("Confirm Action",e,d,false,false)};c.setupInitialLocationView=function(){var h=this;var d=a("#newLocationButton");var f=a("#deleteLocationButton");var g=a("#saveLocationButton");var e=a("#cancelLocationButton");var i=a("#locationsSelect");f.attr("disabled","disabled");g.attr("disabled","disabled").hide();e.attr("disabled","disabled").hide();i.on("change",function(l){var j=i.find("option:selected");if(j.length>0){var k=a(this).val();h.resetLocationView();if(k=="none"){return}h.loadLocation(k)}else{h.resetLocationView()}});d.on("click",function(k){k.preventDefault();i.attr("disabled","disabled");i.val("none");var j={aid:c.params.aid,output:"html"};c.setupNewLocationView(j);d.attr("disabled","disabled");f.attr("disabled","disabled")});f.on("click",function(k){k.preventDefault();var j=c.createDeleteModal();j.modal({loading:false,replace:false,modalOverflow:false});a("button#yes").off("click");a("button#yes").on("click",function(n){var m=i.val();var o='<div id="loading"><img src="'+utilities.urls.base+'/images/spinners/ajax-loader.gif" alt="Loading..." /></div>';i.attr("disabled","disabled");d.attr("disabled","disabled");f.attr("disabled","disabled");g.attr("disabled","disabled").hide();e.attr("disabled","disabled").hide();f.parent().prepend(o);var l={aid:c.params.id,id:m,pk:m,output:"html"};a.ajax({url:c.endpoints.location.deleteRecord,data:l,type:"POST",dataType:"html",success:function(p,q,s){a("button#yes").off("click");var t=false;try{t=JSON.parse(p)}catch(r){t=false}if(t!==false){window.setTimeout(function(){i.removeAttr("disabled");d.removeAttr("disabled");f.removeAttr("disabled");f.parent().find("#loading").remove();utilities.ajaxError.show("Error","Failed to delete the venue",s,"error","Login Required")},1000);return}i.find('option[value="'+m+'"]').remove();i.val("none").trigger("change");a("#tableEventVenueFilter").find('option[value="'+m+'"]').remove();i.removeAttr("disabled");d.removeAttr("disabled");f.parent().find("#loading").remove()},error:function(r,p,q){a("button#yes").off("click");i.removeAttr("disabled");d.removeAttr("disabled");f.removeAttr("disabled");f.parent().find("#loading").remove();utilities.ajaxError.show("Error","Failed to delete the venue",r,p,q)}})})});g.on("click",function(j){j.preventDefault();var k='<div id="loading"><img src="'+utilities.urls.base+'/images/spinners/ajax-loader.gif" alt="Loading..." /></div>';i.attr("disabled","disabled");d.attr("disabled","disabled");f.attr("disabled","disabled");g.attr("disabled","disabled");e.attr("disabled","disabled");g.parent().prepend(k);a(".location-editable").editable("submit",{url:c.endpoints.location.newRecord,ajaxOptions:{dataType:"json"},success:function(s,n){g.removeAttr("disabled");e.removeAttr("disabled");g.parent().find("#loading").remove();if(s&&s.id){a(this).editable("option","pk",s.id);a("#Location_tags").editable("setValue",s.tags);a(this).removeClass("editable-unsaved");var r=a("#Location_name").editable("getValue");var l=a("#Location_status_id").text();var q=a("#Location_type_id").text();var p=r.name+" - "+q+" ("+l+")";var o='<option value="'+s.id+'">'+p+"</option>";i.append(o);a("#tableEventVenueFilter").append('<option value="'+s.id+'">'+r.name.replace(" ","_")+"</option>");i.val(s.id);g.attr("disabled","disabled").hide(250);e.attr("disabled","disabled").hide(250);i.removeAttr("disabled");d.removeAttr("disabled");f.removeAttr("disabled");var m='<div class="alert alert-success"><button type="button" class="close" data-dismiss="alert">&times;</button><h3><span class="badge badge-success">New location added!</span></h3></div>';a("#locationDetails").prepend(m)}else{if(s&&s.errors){n.error.call(this,s.errors)}else{if(s&&s.error){n.error.call(this,s.error)}}}},error:function(o){g.removeAttr("disabled");e.removeAttr("disabled");g.parent().find("#loading").remove();var n="";if(o&&o.responseText){n=o.responseText;utilities.ajaxError.show("Error","Failed to add the new location",o,"error","Unknown")}else{try{if(o){o=JSON.parse(o)}a.each(o,function(q,p){n+=p+"<br>"})}catch(m){o=false}}var l='<div class="alert alert-error"><button type="button" class="close" data-dismiss="alert">&times;</button><h3><span class="badge badge-important">Please correct the following errors:</span></h3>'+n+"</div>";a("#locationDetails").prepend(l)}})});e.on("click",function(j){j.preventDefault();c.resetLocationView()})};c.setupLocationEditables=function(d){a("#Location_name").editable({params:d,success:function(f,j){if(f&&f.length>0){return"Data not saved. Please refresh the page as it appears the session has expired."}var e=a("#Location_status_id").text();var i=a("#Location_type_id").text();var h=j+" - "+i+" ("+e+")";var g=a("#locationsSelect");var k=g.val();if(k=="none"){return}g.find('option[value="'+k+'"]').text(h);a("#tableEventVenueFilter").find('option[value="'+k+'"]').text(j.replace(" ","_"))}});a("#Location_external_id").editable({params:d});a("#Location_status_id").editable({params:d,showbuttons:false,source:c.locationStatuses,success:function(j,f){if(j&&j.length>0){return"Data not saved. Please refresh the page as it appears the session has expired."}var m=a("#Location_name").editable("getValue");var h="";for(var k=0;k<c.locationStatuses.length;k++){if(c.locationStatuses[k].value==f){h=c.locationStatuses[k]["text"];break}}var g=a("#Location_type_id").text();var l=m.name+" - "+g+" ("+h+")";var n=a("#locationsSelect");var e=n.val();if(e=="none"){return}n.find('option[value="'+e+'"]').text(l)}});a("#Location_type_id").editable({params:d,showbuttons:false,source:c.locationTypes,success:function(j,f){if(j&&j.length>0){return"Data not saved. Please refresh the page as it appears the session has expired."}var m=a("#Location_name").editable("getValue");var h=a("#Location_status_id").text();var g="";for(var k=0;k<c.locationTypes.length;k++){if(c.locationTypes[k].value==f){g=c.locationTypes[k]["text"];break}}var l=m.name+" - "+g+" ("+h+")";var n=a("#locationsSelect");var e=n.val();if(e=="none"){return}n.find('option[value="'+e+'"]').text(l)}});a("#Location_notes").editable({params:d,toggle:"manual"});a("#Location_notes_edit").off("click");a("#Location_notes_edit").on("click",function(f){f.stopPropagation();f.preventDefault();a("#Location_notes").editable("toggle")});a("#Location_description").editable({params:d,toggle:"manual"});a("#Location_description_edit").off("click");a("#Location_description_edit").on("click",function(f){f.stopPropagation();f.preventDefault();a("#Location_description").editable("toggle")});a("#Location_tags").editable({params:d});a("#Location_length").editable({params:d});a("#Location_width").editable({params:d});a("#Location_radius").editable({params:d});a("#Location_seating").editable({params:d})};c.setupLocationView=function(e,i){var g=a("#locationDetails");var h=a(".location-editable");a("#Location_notes_edit").off("click");a("#Location_description_edit").off("click");if(h.length>0){h.each(function(){a(this).editable("destroy")})}var f='<strong>Details</strong><br /><table class="table table-condensed table-information"><tbody>';f+='<tr><td style="width:33%">Name</td><td><a href="#" id="Location_name" data-name="name" data-type="text" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" data-pk="'+e.id+'" data-value="'+e.name+'" title="Venue Name" class="location-editable">'+e.name+"</a></td></tr>";f+='<tr><td style="width:33%">External ID</td><td><a href="#" id="Location_external_id" data-name="external_id" data-type="text" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" data-pk="'+e.id+'" data-value="'+(e.external_id?e.external_id:"")+'" title="Your Venue ID" class="location-editable">'+(e.external_id?e.external_id:"")+"</a></td></tr>";f+='<tr><td style="width:33%">Tags</td><td><a href="#" id="Location_tags" data-name="tags" data-type="text" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" data-pk="'+e.id+'" data-value="'+e.tags+'" title="Venue Tags" class="location-editable">'+e.tags+"</a></td></tr>";f+='<tr><td style="width:33%">Type</td><td><a href="#" id="Location_type_id" data-name="type_id" data-type="select" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" data-pk="'+e.id+'" data-value="'+e.type_id+'" title="Venue Type" class="location-editable">'+e.type+"</a></td></tr>";f+='<tr><td style="width:33%">Status</td><td><a href="#" id="Location_status_id" data-name="status_id" data-type="select" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" data-pk="'+e.id+'" data-value="'+e.status_id+'" title="Venue Status" class="location-editable">'+e.status+"</a></td></tr>";f+="</tbody></table>";f+='<strong>Additional Details</strong><br /><table class="table table-condensed table-information"><tbody>';f+='<tr><td style="width:33%">Length (ft)</td><td><a href="#" id="Location_length" data-name="length" data-type="text" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" data-pk="'+e.id+'" data-value="'+(e.length?e.length:"")+'" title="Venue length in feet" class="location-editable">'+(e.length?e.length:"")+"</a></td></tr>";f+='<tr><td style="width:33%">Width (ft)</td><td><a href="#" id="Location_width" data-name="width" data-type="text" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" data-pk="'+e.id+'" data-value="'+(e.width?e.width:"")+'" title="Venue width in feet" class="location-editable">'+(e.width?e.width:"")+"</a></td></tr>";f+='<tr><td style="width:33%">Radius (ft)</td><td><a href="#" id="Location_radius" data-name="radius" data-type="text" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" data-pk="'+e.id+'" data-value="'+(e.radius?e.radius:"")+'" title="Venue readius in feet" class="location-editable">'+(e.radius?e.radius:"")+"</a></td></tr>";f+='<tr><td style="width:33%">Seating Capacity</td><td><a href="#" id="Location_seating" data-name="seating" data-type="text" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" data-pk="'+e.id+'" data-value="'+(e.seating?e.seating:"")+'" title="Venue seating capacity" class="location-editable">'+(e.seating?e.seating:"")+"</a></td></tr>";f+="</tbody></table>";f+='<strong>Description & Notes</strong><br /><table class="table table-condensed table-information"><tbody>';f+='<tr><td style="width:33%">Description<i class="fa fa-lg fa-fw fa-pencil" style="padding-right: 5px"></i> <a href="#" id="Location_description_edit"><span>[edit]</span></a></td><td><div id="Location_description" data-name="description" data-type="wysihtml5" data-mode="inline" data-toggle="manual" data-url="'+c.endpoints.location.updateRecord+'" data-pk="'+e.id+'" title="Venue Description" class="location-editable">'+(e.description?e.description:"")+"</div></td></tr>";f+='<tr><td style="width:33%">Notes<i class="fa fa-lg fa-fw fa-pencil" style="padding-right: 5px"></i> <a href="#" id="Location_notes_edit"><span>[edit]</span></a></td><td><div id="Location_notes" data-name="notes" data-type="wysihtml5" data-mode="inline" data-toggle="manual" data-url="'+c.endpoints.location.updateRecord+'" data-pk="'+e.id+'" title="Venue Notes" class="location-editable">'+(e.notes?e.notes:"")+"</div></td></tr>";f+="</tbody></table>";var d=a('<div id="locationDetails">'+f+"</div>");d.hide();g.fadeOut(500,function(){g.parent().prepend(d);c.setupLocationEditables(i);d.fadeIn(500,function(){var j=a("#newLocationButton");var k=a("#deleteLocationButton");var l=a("#locationsSelect");l.removeAttr("disabled");j.removeAttr("disabled");k.removeAttr("disabled");l.parent().find("#loading").remove();g.remove()})})};c.setupNewLocationView=function(h){var f=a("#locationDetails");var g=a(".location-editable");a("#Location_notes_edit").off("click");a("#Location_description_edit").off("click");if(g.length>0){g.each(function(){a(this).editable("destroy")})}var e='<strong>Details</strong><br /><table class="table table-condensed table-information"><tbody>';e+='<tr><td style="width:33%">Name</td><td><a href="#" id="Location_name" data-name="name" data-type="text" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" title="Venue Name" class="location-editable"></a></td></tr>';e+='<tr><td style="width:33%">External ID</td><td><a href="#" id="Location_external_id" data-name="external_id" data-type="text" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" title="Your Venue ID" class="location-editable"></a></td></tr>';e+='<tr><td style="width:33%">Tags</td><td><a href="#" id="Location_tags" data-name="tags" data-type="text" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" title="Venue Tags" class="location-editable"></a></td></tr>';e+='<tr><td style="width:33%">Type</td><td><a href="#" id="Location_type_id" data-name="type_id" data-type="select" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" data-value="1" title="Venue Type" class="location-editable"></a></td></tr>';e+='<tr><td style="width:33%">Status</td><td><a href="#" id="Location_status_id" data-name="status_id" data-type="select" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" data-value="1" title="Venue Status" class="location-editable"></a></td></tr>';e+="</tbody></table>";e+='<strong>Email & Phone</strong><br /><table class="table table-condensed table-information"><tbody>';e+='<tr><td style="width:33%">Length (ft)</td><td><a href="#" id="Location_length" data-name="length" data-type="text" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" title="Venue length in feet" class="location-editable"></a></td></tr>';e+='<tr><td style="width:33%">Width (ft)</td><td><a href="#" id="Location_width" data-name="width" data-type="text" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" title="Venue width in feet" class="location-editable"></a></td></tr>';e+='<tr><td style="width:33%">Radius (ft)</td><td><a href="#" id="Location_radius" data-name="radius" data-type="text" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" title="Venue readius in feet" class="location-editable"></a></td></tr>';e+='<tr><td style="width:33%">Seating Capacity</td><td><a href="#" id="Location_seating" data-name="seating" data-type="text" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" title="Venue seating capacity" class="location-editable"></a></td></tr>';e+='<tr style="display:none;"><td>Arena ID</td><td><a href="#" id="Location_arena_id" data-name="aid" data-type="text" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" data-value="'+c.params.aid+'" title="Arena ID" class="location-editable">'+c.params.aid+"</a></td></tr>";e+='<tr style="display:none;"><td>Output</td><td><a href="#" id="Location_output" data-name="output" data-type="text" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" data-value="json" title="Output" class="location-editable">json</a></td></tr>';e+="</tbody></table>";e+='<strong>Description & Notes</strong><br /><table class="table table-condensed table-information"><tbody>';e+='<tr><td style="width:33%">Description<i class="fa fa-lg fa-fw fa-pencil" style="padding-right: 5px"></i> <a href="#" id="Location_description_edit"><span>[edit]</span></a></td><td><div id="Location_description" data-name="description" data-type="wysihtml5" data-toggle="manual" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" title="Venue Description" class="location-editable"></div></td></tr>';e+='<tr><td style="width:33%">Notes<i class="fa fa-lg fa-fw fa-pencil" style="padding-right: 5px"></i> <a href="#" id="Location_notes_edit"><span>[edit]</span></a></td><td><div id="Location_notes" data-name="notes" data-type="wysihtml5" data-toggle="manual" data-mode="inline" data-url="'+c.endpoints.location.updateRecord+'" title="Venue Notes" class="location-editable"></div></td></tr>';e+="</tbody></table>";var d=a('<div id="locationDetails">'+e+"</div>");d.hide();f.fadeOut(500,function(){f.parent().prepend(d);c.setupLocationEditables(h);a("#Location_arena_id").editable({params:h});a("#Location_output").editable({params:h});d.fadeIn(500,function(){var j=a("#saveLocationButton");var i=a("#cancelLocationButton");j.removeAttr("disabled").show(250);i.removeAttr("disabled").show(250);f.remove()})})};c.resetLocationView=function(){var g=a("#locationDetails");var j=a(".location-editable");var d=a("#newLocationButton");var f=a("#deleteLocationButton");var h=a("#saveLocationButton");var e=a("#cancelLocationButton");var i=a("#locationsSelect");d.attr("disabled","disabled");f.attr("disabled","disabled");h.attr("disabled","disabled").hide();e.attr("disabled","disabled").hide();a("#Location_notes_edit").off("click");a("#Location_description_edit").off("click");if(j.length>0){j.each(function(){a(this).editable("destroy")})}g.fadeOut(500,function(){g.empty();g.fadeIn(500,function(){d.removeAttr("disabled");i.removeAttr("disabled")})})};c.loadLocation=function(g){var e=a("#newLocationButton");var h=a("#deleteLocationButton");var i=a("#saveLocationButton");var f=a("#cancelLocationButton");var j=a("#locationsSelect");var k='<div id="loading"><img src="'+utilities.urls.base+'/images/spinners/ajax-loader.gif" alt="Loading..." /></div>';e.attr("disabled","disabled");h.attr("disabled","disabled");i.attr("disabled","disabled").hide();f.attr("disabled","disabled").hide();j.attr("disabled","disabled");j.parent().append(k);var d={id:g,aid:c.params.aid,output:"json"};a.ajax({url:c.endpoints.location.viewRecord,data:d,type:"GET",dataType:"json",success:function(l,m,n){if(l.error&&l.error==="LOGIN_REQUIRED"){j.removeAttr("disabled");e.removeAttr("disabled");h.removeAttr("disabled");j.parent().find("#loading").remove();window.setTimeout(function(){j.removeAttr("disabled");e.removeAttr("disabled");h.removeAttr("disabled");utilities.ajaxError.show("Error","Failed to load the venue",n,"error","Login Required")},1000);return}d.output="html";if(l.data&&l.data.id!=="undefined"){c.setupLocationView(l.data,d)}},error:function(n,l,m){j.removeAttr("disabled");e.removeAttr("disabled");h.removeAttr("disabled");j.parent().find("#loading").remove();utilities.ajaxError.show("Error","Failed to load the venue",n,l,m)}})};c.setupInitialEventView=function(){var e=a("#retrieveEventButton");var g=a("#exportEventButton");var d=a("#deleteEventButton");var f=a("#eventFootable");g.attr("disabled","disabled");d.attr("disabled","disabled");e.on("click",function(h){h.preventDefault();c.retrieveEventsTable()});g.on("click",function(h){h.preventDefault();c.exportEventsTable()});d.on("click",function(h){h.preventDefault();c.deleteEventsTable()});f.footable({addRowToggle:false});a("#eventFootable").footable().on("footable_filtering",function(k){var j=a("#tableEventVenueFilter").find(":selected").text();var i=utilities.replaceAll(" ","_",a("#tableEventTypeFilter").find(":selected").text());var h="__"+a("#tableEventStatusFilter").find(":selected").text()+"__";if(h==="____"){h=""}if(j&&j.length>0){k.filter+=(k.filter&&k.filter.length>0)?" "+j:j;k.clear=!k.filter}if(i&&i.length>0){k.filter+=(k.filter&&k.filter.length>0)?" "+i:i;k.clear=!k.filter}if(h&&h.length>0){k.filter+=(k.filter&&k.filter.length>0)?" "+h:h;k.clear=!k.filter}});a(".clear-filter").click(function(h){h.preventDefault();a("#tableEventVenueFilter").val("");a("#tableEventTypeFilter").val("");a("#tableEventStatusFilter").val("")});a("#tableEventVenueFilter, #tableEventTypeFilter, #tableEventStatusFilter").change(function(h){h.preventDefault();a("#eventFootable").trigger("footable_filter",{filter:a("#tableEventFilter").val()})})};c.exportEventsTable=function(){var n=a("#eventFootable");var h=a("#eventFootable").find("#eventFootableBody");var m=h.find("tr").not(".footable-row-detail").not(".footable-filtered");if(m.length<=0){return}var i=a("#retrieveEventButton");var k=a("#exportEventButton");var g=a("#deleteEventButton");i.prop("disabled",true);k.prop("disabled",true);g.prop("disabled",true);var l='<div id="loading"><img src="'+utilities.urls.base+'/images/spinners/ajax-loader.gif" alt="Loading..." /></div>';k.parent().prepend(l);var d=[];m.each(function(){var p=a(this).data("event_id");var q=a(this).data("arena_id");d.push({id:p,aid:q})});var o=n.data("footable");var j={events:d};var e=c.endpoints.event.exportRecord;a("#eventsExportForm").remove();var f=a('<form id="eventsExportForm" method="POST" action="'+e+'">');a.each(d,function(q,p){f.append(a('<input type="hidden" name="events['+q+'][id]" value="'+p.id+'">'));f.append(a('<input type="hidden" name="events['+q+'][aid]" value="'+p.aid+'">'))});a("body").append(f);f.submit();f.remove();i.prop("disabled",false);k.prop("disabled",false);g.prop("disabled",false);k.parent().find("#loading").remove()};c.deleteEventsTable=function(){var g=a("#eventFootable");var d=a("#eventFootable").find("#eventFootableBody");var f=d.find("tr").not(".footable-row-detail").not(".footable-filtered");if(f.length<=0){return}var e=c.createDeleteAllModal();e.modal({loading:false,replace:false,modalOverflow:false});a("button#yes").off("click");a("button#yes").on("click",function(n){var k=a("#retrieveEventButton");var l=a("#exportEventButton");var j=a("#deleteEventButton");k.attr("disabled","disabled");l.attr("disabled","disabled");j.attr("disabled","disabled");var o='<div id="loading"><img src="'+utilities.urls.base+'/images/spinners/ajax-loader.gif" alt="Loading..." /></div>';j.parent().prepend(o);var i=[];f.each(function(){var p=a(this).data("event_id");var q=a(this).data("arena_id");i.push({id:p,aid:q})});var m=g.data("footable");var h={events:i,output:"html"};a.ajax({url:c.endpoints.event.deleteAllRecord,data:h,type:"POST",dataType:"html",success:function(q,r,t){var u=false;try{u=JSON.parse(q)}catch(s){u=false}if(u!==false){window.setTimeout(function(){k.removeAttr("disabled");l.removeAttr("disabled");j.removeAttr("disabled");j.parent().find("#loading").remove();utilities.ajaxError.show("Error","Failed to delete the events",t,"error","Login Required")},1000);return}f.each(function(){m.removeRow(this)});var p='<div class="alert alert-success"><button type="button" class="close" data-dismiss="alert">&times;</button><strong>Success!</strong> Deleted '+f.length+" events.</div>";g.parent().prepend(p);f=d.find("tr").not(".footable-row-detail");if(f.length>1){j.prop("disabled",false)}k.removeAttr("disabled");l.removeAttr("disabled");j.parent().find("#loading").remove()},error:function(r,p,q){k.removeAttr("disabled");l.removeAttr("disabled");j.removeAttr("disabled");j.parent().find("#loading").remove();utilities.ajaxError.show("Error","Failed to delete the events",r,p,q)}})})};c.retrieveEventsTable=function(h){var g=a("#retrieveEventButton");var i=a("#exportEventButton");var f=a("#deleteEventButton");var k='<div id="loading"><img src="'+utilities.urls.base+'/images/spinners/ajax-loader.gif" alt="Loading..." /></div>';var j=i.prop("disabled");var e=f.prop("disabled");i.prop("disabled");f.prop("disabled");g.attr("disabled","disabled");g.parent().append(k);var d={aid:c.params.aid,output:"json"};a.ajax({url:c.endpoints.event.searchRecord,data:d,type:"GET",dataType:"json",success:function(l,m,n){if(l.error&&l.error==="LOGIN_REQUIRED"){i.prop("disabled",j);f.prop("disabled",e);g.removeAttr("disabled");g.parent().find("#loading").remove();utilities.ajaxError.show("Error","Failed to retrieve the events",n,"error","Login Required");return}d.output="html";if(l.data&&l.data.count!=="undefined"){c.setupEventView(l.data,d)}},error:function(n,l,m){i.prop("disabled",j);f.prop("disabled",e);g.removeAttr("disabled");g.parent().find("#loading").remove();utilities.ajaxError.show("Error","Failed to retrieve the events",n,l,m)}})};c.setupEventView=function(g,e){var m=a("#eventFootable");var f=a("#eventFootable").find("#eventFootableBody");var l=f.find("tr").not(".footable-row-detail");var p=m.data("footable");var n=g.events;f.empty();for(var h=0;h<g.count;h++){var o='<tr data-event_id="'+n[h].id+'" data-arena_id="'+n[h].arena_id+'">';o+='<td data-value="'+n[h].id+'">'+n[h].eventName+"</td>";if(n[h].location_name){o+='<td data-value="'+utilities.replaceAll(" ","_",n[h].location_name)+'">'+utilities.replaceAll(" ","_",n[h].location_name)+"</td>"}else{o+='<td data-value=""></td>'}o+='<td data-value="'+utilities.replaceAll(" ","_",n[h].etype)+'">'+utilities.replaceAll(" ","_",n[h].etype)+"</td>";o+='<td data-value="__'+n[h].estatus+'__">__'+n[h].estatus+"__</td>";o+="</tr>";f.append(o)}p.redraw();var j=a("#retrieveEventButton");var k=a("#exportEventButton");var d=a("#deleteEventButton");j.prop("disabled",false);j.parent().find("#loading").remove();k.prop("disabled",false);d.prop("disabled",false)};c.createDeleteAllModal=function(){var e='<div id="deleteAllModal" class="well"><h3>Are you sure you want to permanently delete all of these items?</h3><p class="lead text-error">This operation cannot be undone and will also delete any related items For example, deleting a location / venue will also delete any events associated with that location / venue.</p></div>';var d='<button class="btn btn-large btn-danger" data-dismiss="modal" type="button" aria-hidden="true" id="yes"><i class="fa fa-fw fa-lg fa-check"></i> Yes</button><button class="btn btn-large" data-dismiss="modal" type="button" aria-hidden="true" id="close"><i class="fa fa-fw fa-lg fa-times"></i> No</button>';return utilities.modal.add("Confirm Action",e,d,false,false)};c.setupInitialManagerView=function(){var d=a("#assignManagerButton");var f=a("#unassignManagerButton");var g=a("#availableManagersMSelect");var e=a("#assignedManagersMSelect");d.attr("disabled","disabled");f.attr("disabled","disabled");g.on("change",function(i){var h=g.find("option:selected");if(h.length>0){d.removeAttr("disabled")}else{d.attr("disabled","disabled")}});e.on("change",function(i){var h=e.find("option:selected");if(h.length>0){f.removeAttr("disabled")}else{f.attr("disabled","disabled")}});d.on("click",function(k){k.preventDefault();var l='<div id="loading"><img src="'+utilities.urls.base+'/images/spinners/ajax-loader.gif" alt="Loading..." /></div>';var j=g.find("option:selected");var i=[];j.each(function(){i.push(a(this).val())});if(i.length<=0){return}d.attr("disabled","disabled");f.attr("disabled","disabled");g.attr("disabled","disabled");e.attr("disabled","disabled");d.parent().prepend(l);var h={name:"assign",value:i,aid:c.params.id,output:"html"};a.ajax({url:c.endpoints.manager.updateRecord,data:h,type:"POST",dataType:"html",success:function(m,n,p){var q=false;try{q=JSON.parse(m)}catch(o){q=false}if(q!==false){window.setTimeout(function(){g.removeAttr("disabled");e.removeAttr("disabled");d.removeAttr("disabled");d.parent().find("#loading").remove();utilities.ajaxError.show("Error","Failed to assign the managers",p,"error","Login Required")},1000);return}j.each(function(){e.append('<option value="'+a(this).val()+'">'+a(this).text()+"</option>");a(this).remove()});g.val("");e.val("");g.removeAttr("disabled");e.removeAttr("disabled");d.parent().find("#loading").remove()},error:function(o,m,n){g.removeAttr("disabled");e.removeAttr("disabled");d.removeAttr("disabled");d.parent().find("#loading").remove();utilities.ajaxError.show("Error","Failed to assign the managers",o,m,n)}})});f.on("click",function(k){k.preventDefault();var l='<div id="loading"><img src="'+utilities.urls.base+'/images/spinners/ajax-loader.gif" alt="Loading..." /></div>';var j=e.find("option:selected");var i=[];j.each(function(){i.push(a(this).val())});if(i.length<=0){return}d.attr("disabled","disabled");f.attr("disabled","disabled");g.attr("disabled","disabled");e.attr("disabled","disabled");f.parent().prepend(l);var h={name:"unassign",value:i,aid:c.params.id,id:1,pk:1,output:"html"};a.ajax({url:c.endpoints.manager.updateRecord,data:h,type:"POST",dataType:"html",success:function(m,n,p){var q=false;try{q=JSON.parse(m)}catch(o){q=false}if(q!==false){window.setTimeout(function(){g.removeAttr("disabled");e.removeAttr("disabled");f.removeAttr("disabled");f.parent().find("#loading").remove();utilities.ajaxError.show("Error","Failed to unassign the managers",p,"error","Login Required")},1000);return}j.each(function(){g.append('<option value="'+a(this).val()+'">'+a(this).text()+"</option>");a(this).remove()});g.val("");e.val("");g.removeAttr("disabled");e.removeAttr("disabled");f.parent().find("#loading").remove()},error:function(o,m,n){g.removeAttr("disabled");e.removeAttr("disabled");f.removeAttr("disabled");f.parent().find("#loading").remove();utilities.ajaxError.show("Error","Failed to unassign the managers",o,m,n)}})})};c.resetManagerView=function(){var d=a("#newManagerButton");d.prop("disabled",false)}}(window.arenaManagementView=window.arenaManagementView||{},jQuery));