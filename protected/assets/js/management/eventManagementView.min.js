(function(a,b,c){a.endpoints={event:{viewRecord:"/server/endpoint",updateRecord:"/server/endpoint",newRecord:"/server/endpoint",deleteRecord:"/server/endpoint"}};a.newRecord=false;a.event={};a.arenas=[];a.locations=[];a.eventTypes=[];a.eventStatuses=[];a.params={};a.isArenaManager=false;a.Id=0;a.Name="";a.onReady=function(){if(typeof b.fn.editable==="undefined"){a.loadEditable()}else{a.setupInitialEventView()}var d=b("#eventManagementView.panel.panel-primary");if(d.length>0){d.on("destroyed",function(){var e=b("#eventManagementView.panel.panel-primary .editable");e.editable("destroy")})}b('[data-toggle="tooltip"]').tooltip()};a.loadEditable=function(){var e=utilities.debug?"bootstrap-editable.js":"bootstrap-editable.min.js";b.ajax({url:utilities.urls.assets+(utilities.debug?"/bootstrap-editable/js/bootstrap-editable.js":"/bootstrap-editable/js/bootstrap-editable.min.js"),dataType:"script",cache:true,success:function(){console.log("Loaded: "+e)},error:function(h,f,g){utilities.ajaxError.show("Error","Failed to retrieve javsScript file",h,f,g)}});var d=setInterval(function(){if(typeof typeof b.fn.editable!=="undefined"){clearInterval(d);a.setupInitialEventView()}else{if(console&&console.log){console.log("Loading... "+e)}}},500)};a.createDeleteModal=function(){var e='<div id="deleteModal" class="well"><h3>Are you sure you want to permanently delete this item?</h3><p class="lead text-error">This operation cannot be undone and will also delete this item from any related items. For example, deleting a event / event will also delete any events associated with that event / event.</p></div>';var d='<button class="btn btn-large btn-danger" data-dismiss="modal" type="button" aria-hidden="true" id="yes"><i class="fa fa-fw fa-lg fa-check"></i> Yes</button><button class="btn btn-large" data-dismiss="modal" type="button" aria-hidden="true" id="close"><i class="fa fa-fw fa-lg fa-times"></i> No</button>';return utilities.modal.add("Confirm Action",e,d,false,false)};a.setupInitialEventView=function(){var i=this;var d=b("#newEventButton");var f=b("#deleteEventButton");var h=b("#saveEventButton");var e=b("#cancelEventButton");var g=b("#eventsSelect");f.attr("disabled","disabled");h.attr("disabled","disabled").hide();e.attr("disabled","disabled").hide();g.on("change",function(l){var j=g.find("option:selected");if(j.length>0){var k=b(this).val();i.resetEventView();if(k=="none"){return}i.loadEvent(k)}else{i.resetEventView()}});d.on("click",function(k){k.preventDefault();g.attr("disabled","disabled");g.val("none");var j={output:"html"};a.newRecord=true;a.setupNewEventView(j);d.attr("disabled","disabled");f.attr("disabled","disabled")});f.on("click",function(k){k.preventDefault();var j=a.createDeleteModal();j.modal({loading:false,replace:false,modalOverflow:false});b("button#yes").on("click",function(n){var m=g.val();var o='<div id="loading"><img src="'+utilities.urls.base+'/images/spinners/ajax-loader.gif" alt="Loading..." /></div>';g.attr("disabled","disabled");d.attr("disabled","disabled");f.attr("disabled","disabled");h.attr("disabled","disabled").hide();e.attr("disabled","disabled").hide();f.parent().prepend(o);var l={aid:a.params.id,id:m,pk:m,output:"html"};b.ajax({url:a.endpoints.event.deleteRecord,data:l,type:"POST",dataType:"html",success:function(p,q,s){var t=false;try{t=JSON.parse(p)}catch(r){t=false}if(t!==false){window.setTimeout(function(){g.removeAttr("disabled");d.removeAttr("disabled");f.removeAttr("disabled");utilities.ajaxError.show("Error","Failed to delete the event",s,"error","Login Required")},1000);return}g.find('option[value="'+m+'"]').remove();g.val("none").trigger("change");g.removeAttr("disabled");d.removeAttr("disabled");f.parent().find("#loading").remove()},error:function(r,p,q){g.removeAttr("disabled");d.removeAttr("disabled");f.parent().find("#loading").remove();utilities.ajaxError.show("Error","Failed to delete the event",r,p,q)}})})});h.on("click",function(j){j.preventDefault();var k='<div id="loading"><img src="'+utilities.urls.base+'/images/spinners/ajax-loader.gif" alt="Loading..." /></div>';g.attr("disabled","disabled");d.attr("disabled","disabled");f.attr("disabled","disabled");h.attr("disabled","disabled");e.attr("disabled","disabled");h.parent().prepend(k);b(".event-editable").editable("submit",{url:a.endpoints.event.newRecord,ajaxOptions:{dataType:"json"},success:function(p,m){h.removeAttr("disabled");e.removeAttr("disabled");h.parent().find("#loading").remove();if(p&&p.id){b(this).editable("option","pk",p.id);b(this).editable("option","params",{id:p.id,aid:p.aid,output:"html"});b("#Event_tags").editable("setValue",p.tags);b("#Event_all_day").editable("setValue",p.all_day);b("#Event_duration").editable("setValue",p.duration);b("#Event_start_date").editable("setValue",p.start_date,true);b("#Event_start_time").editable("setValue",p.start_time,true);b("#Event_end_date").editable("setValue",p.end_date,true);b("#Event_end_time").editable("setValue",p.end_time,true);b(this).removeClass("editable-unsaved");var t=b("#Event_start_date, #Event_start_time").editable("getValue");var n=b("#Event_arena_id").text();var s=b("#Event_location_id").text();var o=b("#Event_status_id").text();var l=b("#Event_type_id").text();var v=moment(t.start_date,["YYYY-MM-DD","MM/DD/YYYY"]);var u=moment(t.start_time,["HH:mm","hh:mm A"]);var q="";if(s===""){q=v.format("M/D/YYYY")+" "+u.format("h:mm A")+" @ "+n+" - "+l+" ("+o+")"}else{q=v.format("M/D/YYYY")+" "+u.format("h:mm A")+" @ "+n+" "+s+" - "+l+" ("+o+")"}var r='<option value="'+p.id+'">'+q+"</option>";g.append(r);g.val(p.id);h.attr("disabled","disabled").hide(250);e.attr("disabled","disabled").hide(250);g.removeAttr("disabled");d.removeAttr("disabled");f.removeAttr("disabled");a.newRecord=false;var w='<div class="alert alert-success"><button type="button" class="close" data-dismiss="alert">&times;</button><h3><span class="badge badge-success">New event added!</span></h3></div>';b("#eventDetails").prepend(w)}else{if(p&&p.errors){m.error.call(this,p.errors)}else{if(p&&p.error){m.error.call(this,p.error)}}}},error:function(o){h.removeAttr("disabled");e.removeAttr("disabled");h.parent().find("#loading").remove();var n="";if(o&&o.responseText){n=o.responseText;utilities.ajaxError.show("Error","Failed to add the new event",o,"error","Unknown")}else{try{if(o&&typeof o==="string"){o=JSON.parse(o)}if(typeof o==="object"){b.each(o,function(q,p){n+=p+"<br>"})}}catch(m){o=false}}var l='<div class="alert alert-error"><button type="button" class="close" data-dismiss="alert">&times;</button><h3><span class="badge badge-important">Please correct the following errors:</span></h3>'+n+"</div>";b("#eventDetails").prepend(l)}})});e.on("click",function(j){j.preventDefault();a.newRecord=false;a.resetEventView()});if(a.newRecord){d.trigger("click")}else{if(a.event&&a.event.id){a.setupEventView(a.event,a.params)}}};a.setupEventEditables=function(d){b("#Event_arena_id").editable({params:d,showbuttons:false,source:a.arenas,validate:function(e){if(b.trim(e)==""){return"Facility is required"}},success:function(l,f){var o=false;try{if(l&&l.length>0){o=JSON.parse(l);if(o.locations){l=null}}}catch(k){o=false}if(l&&l.length>0){return"Data not saved. Please refresh the page as it appears the session has expired."}var p=b("#Event_start_date, #Event_start_time").editable("getValue");var h="";for(var m=0;m<a.arenas.length;m++){if(f==a.arenas[m].value){h=a.arenas[m].text;break}}var j=b("#Event_status_id").text();var g=b("#Event_type_id").text();var r=moment(p.start_date,["YYYY-MM-DD","MM/DD/YYYY"]);var q=moment(p.start_time,["HH:mm","hh:mm A"]);var n=r.format("MM/DD/YYYY")+" "+q.format("hh:mm A")+" @ "+h+" - "+g+" ("+j+")";a.locations=o.locations;b("#Event_location_id").editable("option","source",o.locations);b("#Event_location_id").editable("setValue",null);b(".event-editable").editable("option","params",{aid:f,output:"json"});var s=b("#eventsSelect");var e=s.val();if(e=="none"){return}s.find('option[value="'+e+'"]').text(n)}});b("#Event_arena_id").on("save",function(g,h){if(!h.response){b("#Event_aid").editable("setValue",h.newValue);var f={output:"json",aid:h.newValue,name:"arena_id",value:h.newValue,newRecord:1};b.ajax({url:a.endpoints.event.updateRecord,data:f,type:"POST",dataType:"json",success:function(e,i,j){if(e.error&&e.error==="LOGIN_REQUIRED"){window.setTimeout(function(){utilities.ajaxError.show("Error","Failed to venue listt",j,"error","Login Required")},1000);return}if(e.locations){a.locations=e.locations;b("#Event_location_id").editable("option","source",e.locations);b("#Event_location_id").editable("setValue",null)}},error:function(j,e,i){utilities.ajaxError.show("Error","Failed to load the venue list",j,e,i)}})}});b("#Event_location_id").editable({params:d,showbuttons:false,source:a.locations,success:function(k,f){if(k&&k.length>0){return"Data not saved. Please refresh the page as it appears the session has expired."}var o=b("#Event_start_date, #Event_start_time, #Event_arena_id").editable("getValue");var h=b("#Event_arena_id").text();var n="";for(var l=0;l<a.locations.length;l++){if(f==a.locations[l].value){n=a.locations[l].text;break}}var j=b("#Event_status_id").text();var g=b("#Event_type_id").text();var q=moment(o.start_date,["YYYY-MM-DD","MM/DD/YYYY"]);var p=moment(o.start_time,["HH:mm","hh:mm A"]);var m="";if(n===""){m=q.format("MM/DD/YYYY")+" "+p.format("hh:mm A")+" @ "+h+" - "+g+" ("+j+")"}else{m=q.format("MM/DD/YYYY")+" "+p.format("hh:mm A")+" @ "+h+" "+n+" - "+g+" ("+j+")"}b(".event-editable").editable("option","params",{aid:o.arena_id,lid:f,output:"json"});var r=b("#eventsSelect");var e=r.val();if(e=="none"){return}r.find('option[value="'+e+'"]').text(m)}});b("#Event_external_id").editable({params:d});b("#Event_type_id").editable({params:d,showbuttons:false,source:a.eventTypes,success:function(k,f){if(k&&k.length>0){return"Data not saved. Please refresh the page as it appears the session has expired."}var o=b("#Event_start_date, #Event_start_time").editable("getValue");var h=b("#Event_arena_id").text();var n=b("#Event_location_id").text();var j=b("#Event_status_id").text();var g="";for(var l=0;l<a.eventTypes.length;l++){if(f==a.eventTypes[l].value){g=a.eventTypes[l].text;break}}var q=moment(o.start_date,["YYYY-MM-DD","MM/DD/YYYY"]);var p=moment(o.start_time,["HH:mm","hh:mm A"]);var m="";if(n===""){m=q.format("MM/DD/YYYY")+" "+p.format("hh:mm A")+" @ "+h+" - "+g+" ("+j+")"}else{m=q.format("MM/DD/YYYY")+" "+p.format("hh:mm A")+" @ "+h+" "+n+" - "+g+" ("+j+")"}var r=b("#eventsSelect");var e=r.val();if(e=="none"){return}r.find('option[value="'+e+'"]').text(m)}});b("#Event_status_id").editable({params:d,showbuttons:false,source:a.eventStatuses,success:function(k,f){if(k&&k.length>0){return"Data not saved. Please refresh the page as it appears the session has expired."}var o=b("#Event_start_date, #Event_start_time").editable("getValue");var h=b("#Event_arena_id").text();var n=b("#Event_location_id").text();var j="";var g=b("#Event_type_id").text();for(var l=0;l<a.eventStatuses.length;l++){if(f==a.eventStatuses[l].value){j=a.eventStatuses[l].text;break}}var q=moment(o.start_date,["YYYY-MM-DD","MM/DD/YYYY"]);var p=moment(o.start_time,["HH:mm","hh:mm A"]);var m="";if(n===""){m=q.format("MM/DD/YYYY")+" "+p.format("hh:mm A")+" @ "+h+" - "+g+" ("+j+")"}else{m=q.format("MM/DD/YYYY")+" "+p.format("hh:mm A")+" @ "+h+" "+n+" - "+g+" ("+j+")"}var r=b("#eventsSelect");var e=r.val();if(e=="none"){return}r.find('option[value="'+e+'"]').text(m)}});b("#Event_name").editable({params:d});b("#Event_tags").editable({params:d});b("#Event_all_day").editable({params:d,showbuttons:false,source:[{value:0,text:"No"},{value:1,text:"Yes"}],success:function(f,i){if(a.newRecord){return}var e=false;try{if(f&&f.length>0){var h=JSON.parse(f);if(h.attributes){e=h.attributes;f=null}}}catch(g){e=false}if(f&&f.length>0){return"Data not saved. Please refresh the page as it appears the session has expired."}b("#Event_all_day").editable("setValue",e.all_day);b("#Event_duration").editable("setValue",e.duration);b("#Event_start_date").editable("setValue",e.start_date,true);b("#Event_start_time").editable("setValue",e.start_time,true);b("#Event_end_date").editable("setValue",e.end_date,true);b("#Event_end_time").editable("setValue",e.end_time,true);return{newValue:e.all_day}}});b("#Event_duration").editable({params:d,display:function(g,f){var e="";if(typeof g==="undefined"||g.length<=0){return}b(this).html(g+" minutes")},success:function(f,i){if(a.newRecord){return}var e=false;try{if(f&&f.length>0){var h=JSON.parse(f);if(h.attributes){e=h.attributes;f=null}}}catch(g){e=false}if(f&&f.length>0){return"Data not saved. Please refresh the page as it appears the session has expired."}b("#Event_all_day").editable("setValue",e.all_day);b("#Event_duration").editable("setValue",e.duration);b("#Event_start_date").editable("setValue",e.start_date,true);b("#Event_start_time").editable("setValue",e.start_time,true);b("#Event_end_date").editable("setValue",e.end_date,true);b("#Event_end_time").editable("setValue",e.end_time,true);return{newValue:e.duration}}});b("#Event_start_date").editable({params:d,datepicker:{autoclose:true,cleanBtn:true,endDate:moment().add("years",2).endOf("day").toDate(),startDate:moment().subtract("days",1).startOf("day").toDate(),startView:"month",todayBtn:false,todayHighlight:false},success:function(f,i){if(a.newRecord){return}var e=false;try{if(f&&f.length>0){var h=JSON.parse(f);if(h.attributes){e=h.attributes;f=null}}}catch(g){e=false}if(f&&f.length>0){return"Data not saved. Please refresh the page as it appears the session has expired."}b("#Event_all_day").editable("setValue",e.all_day);b("#Event_duration").editable("setValue",e.duration);b("#Event_start_date").editable("setValue",e.start_date,true);b("#Event_start_time").editable("setValue",e.start_time,true);b("#Event_end_date").editable("setValue",e.end_date,true);b("#Event_end_time").editable("setValue",e.end_time,true);return{newValue:moment(e.start_date,"YYYY-MM-DD").toDate()}}});b("#Event_start_time").editable({params:d,combodate:{minuteStep:1,firstItem:"empty"},success:function(f,i){if(a.newRecord){return}var e=false;try{if(f&&f.length>0){var h=JSON.parse(f);if(h.attributes){e=h.attributes;f=null}}}catch(g){e=false}if(f&&f.length>0){return"Data not saved. Please refresh the page as it appears the session has expired."}b("#Event_all_day").editable("setValue",e.all_day);b("#Event_duration").editable("setValue",e.duration);b("#Event_start_date").editable("setValue",e.start_date,true);b("#Event_start_time").editable("setValue",e.start_time,true);b("#Event_end_date").editable("setValue",e.end_date,true);b("#Event_end_time").editable("setValue",e.end_time,true);return{newValue:moment(e.start_time,"HH:mm")}}});b("#Event_end_date").editable({params:d,datepicker:{autoclose:true,cleanBtn:true,endDate:moment().add("years",2).endOf("day").toDate(),startDate:moment().subtract("days",1).startOf("day").toDate(),startView:"month",todayBtn:false,todayHighlight:false},success:function(f,i){if(a.newRecord){return}var e=false;try{if(f&&f.length>0){var h=JSON.parse(f);if(h.attributes){e=h.attributes;f=null}}}catch(g){e=false}if(f&&f.length>0){return"Data not saved. Please refresh the page as it appears the session has expired."}b("#Event_all_day").editable("setValue",e.all_day);b("#Event_duration").editable("setValue",e.duration);b("#Event_start_date").editable("setValue",e.start_date,true);b("#Event_start_time").editable("setValue",e.start_time,true);b("#Event_end_date").editable("setValue",e.end_date,true);b("#Event_end_time").editable("setValue",e.end_time,true);return{newValue:moment(e.end_date,"YYYY-MM-DD").toDate()}}});b("#Event_end_time").editable({params:d,combodate:{minuteStep:1,firstItem:"empty"},success:function(f,i){if(a.newRecord){return}var e=false;try{if(f&&f.length>0){var h=JSON.parse(f);if(h.attributes){e=h.attributes;f=null}}}catch(g){e=false}if(f&&f.length>0){return"Data not saved. Please refresh the page as it appears the session has expired."}b("#Event_all_day").editable("setValue",e.all_day);b("#Event_duration").editable("setValue",e.duration);b("#Event_start_date").editable("setValue",e.start_date,true);b("#Event_start_time").editable("setValue",e.start_time,true);b("#Event_end_date").editable("setValue",e.end_date,true);b("#Event_end_time").editable("setValue",e.end_time,true);return{newValue:moment(e.end_time,"HH:mm")}}});b("#Event_price").editable({params:d,display:function(g,f){var e="";if(typeof g==="undefined"||g.length<=0){return}b(this).html("$"+g)}});b("#Event_price").on("shown",function(g,f){if(f){b(this).data("editable").input.$input.inputmask({alias:"decimal",placeholder:"$0.00",autoUnmask:true,digits:2,groupSeparator:",",radixPoint:".",autoGroup:true,rightAlignNumerics:true,clearMaskOnLostFocus:true,clearIncomplete:true,showTooltip:true})}});b("#Event_notes").editable({params:d,toggle:"manual"});b("#Event_notes_edit").off("click");b("#Event_notes_edit").on("click",function(f){f.stopPropagation();f.preventDefault();b("#Event_notes").editable("toggle")});b("#Event_description").editable({params:d,toggle:"manual"});b("#Event_description_edit").off("click");b("#Event_description_edit").on("click",function(f){f.stopPropagation();f.preventDefault();b("#Event_description").editable("toggle")})};a.setupEventView=function(h,i){var g=b("#eventDetails");var f=b(".event-editable");b("#Event_notes_edit").off("click");b("#Event_description_edit").off("click");if(f.length>0){f.each(function(){b(this).editable("destroy")})}var d='<strong>General Details</strong><br /><table class="table table-condensed table-information"><tbody>';d+='<tr><td style="width:33%">Facility</td><td><a href="#" id="Event_arena_id" data-name="arena_id" data-type="select" data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" data-pk="'+h.id+'" data-value="'+h.arena_id+'" title="Facility" class="event-editable">'+h.arena_name+"</a></td></tr>";d+='<tr><td style="width:33%">Venue</td><td><a href="#" id="Event_location_id" data-name="location_id" data-type="select" data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" data-pk="'+h.id+'" data-value="'+(h.location_id?h.location_id:"")+'" title="Venue" class="event-editable">'+(h.location_id?h.location_name:"")+"</a></td></tr>";d+='<tr><td style="width:33%">Name</td><td><a href="#" id="Event_name" data-name="name" data-type="text" data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" data-pk="'+h.id+'" data-value="'+(h.name?h.name:"")+'" title="Event Name" class="event-editable">'+(h.name?h.name:"")+"</a></td></tr>";d+='<tr><td style="width:33%">External ID</td><td><a href="#" id="Event_external_id" data-name="external_id" data-type="text" data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" data-pk="'+h.id+'" data-value="'+(h.external_id?h.external_id:"")+'" title="Your Event ID" class="event-editable">'+(h.external_id?h.external_id:"")+"</a></td></tr>";d+='<tr><td style="width:33%">Tags</td><td><a href="#" id="Event_tags" data-name="tags" data-type="text" "data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" data-pk="'+h.id+'" data-value="'+h.tags+'" title="Event Tags" class="event-editable">'+h.tags+"</a></td></tr>";d+='<tr><td style="width:33%">Type</td><td><a href="#" id="Event_type_id" data-name="type_id" data-type="select" data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" data-pk="'+h.id+'" data-value="'+h.type_id+'" title="Event Type" class="event-editable">'+h.type+"</a></td></tr>";d+='<tr><td style="width:33%">Status</td><td><a href="#" id="Event_status_id" data-name="status_id" data-type="select" data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" data-pk="'+h.id+'" data-value="'+h.status_id+'" title="Event Status" class="event-editable">'+h.status+"</a></td></tr>";d+="</tbody></table>";d+='<strong>Event Details</strong><br /><table class="table table-condensed table-information"><tbody>';d+='<tr><td style="width:33%">All Day</td><td><a href="#" id="Event_all_day" data-name="all_day" data-type="select" data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" data-pk="'+h.id+'" data-value="'+h.all_day+'" title="All Day Event" class="event-editable">'+(h.all_day==0?"No":"Yes")+"</a></td></tr>";d+='<tr><td style="width:33%">Start Date</td><td><a href="#" id="Event_start_date" data-name="start_date" data-type="date" data-format="yyyy-mm-dd" data-mode="inline" data-viewFormat="mm/dd/yyyy" data-url="'+a.endpoints.event.updateRecord+'" data-pk="'+h.id+'" data-value="'+h.start_date+'" title="Event Start Date" class="event-editable">'+moment(h.start_date,"YYYY-MM-DD").format("MM/DD/YYYY")+"</a></td></tr>";d+='<tr><td style="width:33%">Start Time</td><td><a href="#" id="Event_start_time" data-name="start_time" data-type="combodate" data-template="hh : mm A" data-format="HH:mm" data-mode="inline" data-viewFormat="hh:mm A" data-url="'+a.endpoints.event.updateRecord+'" data-pk="'+h.id+'" data-value="'+h.start_time+'" title="Event Start Time" class="event-editable">'+moment(h.start_time,"HH:mm:ss").format("hh:mm A")+"</a></td></tr>";d+='<tr><td style="width:33%">End Date</td><td><a href="#" id="Event_end_date" data-name="end_date" data-type="date" data-format="yyyy-mm-dd" data-mode="inline" data-viewFormat="mm/dd/yyyy" data-url="'+a.endpoints.event.updateRecord+'" data-pk="'+h.id+'" data-value="'+(h.end_date?h.end_date:"")+'" title="Event End Date" class="event-editable">'+(h.end_date?moment(h.end_date,"YYYY-MM-DD").format("MM/DD/YYYY"):"")+"</a></td></tr>";d+='<tr><td style="width:33%">End Time</td><td><a href="#" id="Event_end_time" data-name="end_time" data-type="combodate" data-template="hh : mm A" data-format="HH:mm" data-mode="inline" data-viewFormat="hh:mm A" data-url="'+a.endpoints.event.updateRecord+'" data-pk="'+h.id+'" data-value="'+(h.end_time?h.end_time:"")+'" title="Event End Time" class="event-editable">'+(h.end_time?moment(h.end_time,"HH:mm:ss").format("hh:mm A"):"")+"</a></td></tr>";d+='<tr><td style="width:33%">Event Duration</td><td><a href="#" id="Event_duration" data-name="duration" data-type="text" data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" data-pk="'+h.id+'" data-value="'+(h.duration?h.duration:"")+'" title="Event Duration" class="event-editable">'+(h.duration?h.duration:"")+"</a></td></tr>";d+='<tr><td style="width:33%">Event Price</td><td><a href="#" id="Event_price" data-name="price" data-type="text" data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" data-pk="'+h.id+'" data-value="'+(h.price?h.price:"")+'" title="Event Price $" class="event-editable">'+(h.price?h.price:"")+"</a></td></tr>";d+="</tbody></table>";d+='<strong>Description & Notes</strong><br /><table class="table table-condensed table-information"><tbody>';d+='<tr><td style="width:33%">Description<i class="fa fa-lg fa-fw fa-pencil" style="padding-right: 5px"></i> <a href="#" id="Event_description_edit"><span>[edit]</span></a></td><td><div id="Event_description" data-name="description" data-type="wysihtml5" data-mode="inline" data-toggle="manual" data-url="'+a.endpoints.event.updateRecord+'" data-pk="'+h.id+'" data-value="'+(h.description?h.description:"")+'" title="Event Description" class="event-editable">'+(h.description?h.description:"")+"</div></td></tr>";d+='<tr><td style="width:33%">Notes<i class="fa fa-lg fa-fw fa-pencil" style="padding-right: 5px"></i> <a href="#" id="Event_notes_edit"><span>[edit]</span></a></td><td><div id="Event_notes" data-name="notes" data-type="wysihtml5" data-mode="inline" data-toggle="manual" data-url="'+a.endpoints.event.updateRecord+'" data-pk="'+h.id+'" data-value="'+(h.notes?h.notes:"")+'" title="Event Notes" class="event-editable">'+(h.notes?h.notes:"")+"</div></td></tr>";d+="</tbody></table>";var e=b('<div id="eventDetails">'+d+"</div>");e.hide();g.fadeOut(500,function(){g.parent().prepend(e);a.setupEventEditables(i);e.fadeIn(500,function(){var j=b("#newEventButton");var k=b("#deleteEventButton");var l=b("#eventsSelect");l.removeAttr("disabled");j.removeAttr("disabled");k.removeAttr("disabled");l.parent().find("#loading").remove();g.remove()})})};a.setupNewEventView=function(h){var g=b("#eventDetails");var f=b(".event-editable");b("#Event_notes_edit").off("click");b("#Event_description_edit").off("click");if(f.length>0){f.each(function(){b(this).editable("destroy")})}var d='<strong>General Details</strong><br /><table class="table table-condensed table-information"><tbody>';d+='<tr><td style="width:33%">Facility</td><td><a href="#" id="Event_arena_id" data-name="arena_id" data-type="select" data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" title="Event Facility" class="event-editable"></a></td></tr>';d+='<tr><td style="width:33%">Venue</td><td><a href="#" id="Event_location_id" data-name="location_id" data-type="select" data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" title="Event Venue" class="event-editable"></a></td></tr>';d+='<tr><td style="width:33%">Name</td><td><a href="#" id="Event_name" data-name="name" data-type="text" data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" title="Event Name" class="event-editable"></a></td></tr>';d+='<tr><td style="width:33%">External ID</td><td><a href="#" id="Event_external_id" data-name="external_id" data-type="text" data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" title="Your Event ID" class="event-editable"></a></td></tr>';d+='<tr><td style="width:33%">Tags</td><td><a href="#" id="Event_tags" data-name="tags" data-type="text" data-tpl="<input type=\'password\'>" "data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" title="Event Tags" class="event-editable"></a></td></tr>';d+='<tr><td style="width:33%">Type</td><td><a href="#" id="Event_type_id" data-name="type_id" data-type="select" data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" data-value="1" title="Event Type" class="event-editable"></a></td></tr>';d+='<tr><td style="width:33%">Status</td><td><a href="#" id="Event_status_id" data-name="status_id" data-type="select" data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" data-value="1" title="Event Status" class="event-editable"></a></td></tr>';d+="</tbody></table>";d+='<strong>Event Details</strong><br /><table class="table table-condensed table-information"><tbody>';d+='<tr><td style="width:33%">All Day</td><td><a href="#" id="Event_all_day" data-name="all_day" data-type="select" data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" data-value="0" title="All Day Event" class="event-editable"></a></td></tr>';d+='<tr><td style="width:33%">Start Date</td><td><a href="#" id="Event_start_date" data-name="start_date" data-type="date" data-format="yyyy-mm-dd" data-mode="inline" data-viewFormat="mm/dd/yyyy" data-url="'+a.endpoints.event.updateRecord+'" title="Event Start Date" class="event-editable"></a></td></tr>';d+='<tr><td style="width:33%">Start Time</td><td><a href="#" id="Event_start_time" data-name="start_time" data-type="combodate" data-template="hh : mm A" data-format="HH:mm" data-mode="inline" data-viewFormat="hh:mm A" data-url="'+a.endpoints.event.updateRecord+'" title="Event Start Time" class="event-editable"></a></td></tr>';d+='<tr><td style="width:33%">End Date</td><td><a href="#" id="Event_end_date" data-name="end_date" data-type="date" data-format="yyyy-mm-dd" data-mode="inline" data-viewFormat="mm/dd/yyyy" data-url="'+a.endpoints.event.updateRecord+'" title="Event End Date" class="event-editable"></a></td></tr>';d+='<tr><td style="width:33%">End Time</td><td><a href="#" id="Event_end_time" data-name="end_time" data-type="combodate" data-template="hh : mm A" data-format="HH:mm" data-mode="inline" data-viewFormat="hh:mm A" data-url="'+a.endpoints.event.updateRecord+'" title="Event End Time" class="event-editable"></a></td></tr>';d+='<tr><td style="width:33%">Event Duration</td><td><a href="#" id="Event_duration" data-name="duration" data-type="text" data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" title="Event Duration" class="event-editable"></a></td></tr>';d+='<tr><td style="width:33%">Event Price</td><td><a href="#" id="Event_price" data-name="price" data-type="text" data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" title="Event Price $" class="event-editable"></a></td></tr>';d+="</tbody></table>";d+='<strong>Description & Notes</strong><br /><table class="table table-condensed table-information"><tbody>';d+='<tr><td style="width:33%">Description<i class="fa fa-lg fa-fw fa-pencil" style="padding-right: 5px"></i> <a href="#" id="Event_description_edit"><span>[edit]</span></a></td><td><div id="Event_description" data-name="description" data-type="wysihtml5" data-mode="inline" data-toggle="manual" data-url="'+a.endpoints.event.updateRecord+'" title="Event Description" class="event-editable"></div></td></tr>';d+='<tr><td style="width:33%">Notes<i class="fa fa-lg fa-fw fa-pencil" style="padding-right: 5px"></i> <a href="#" id="Event_notes_edit"><span>[edit]</span></a></td><td><div id="Event_notes" data-name="notes" data-type="wysihtml5" data-mode="inline" data-toggle="manual" data-url="'+a.endpoints.event.updateRecord+'" title="Event Notes" class="event-editable"></div></td></tr>';d+='<tr style="display:none;"><td>Arena ID</td><td><a href="#" id="Event_aid" data-name="aid" data-type="text" data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" data-value="'+a.params.aid+'" title="Arena ID" class="event-editable">'+a.params.aid+"</a></td></tr>";d+='<tr style="display:none;"><td>Output</td><td><a href="#" id="Event_output" data-name="output" data-type="text" data-mode="inline" data-url="'+a.endpoints.event.updateRecord+'" data-value="json" title="Output" class="event-editable">json</a></td></tr>';d+="</tbody></table>";var e=b('<div id="eventDetails">'+d+"</div>");e.hide();g.fadeOut(500,function(){g.parent().prepend(e);a.setupEventEditables(h);b("#Event_aid").editable({params:h});b("#Event_output").editable({params:h});e.fadeIn(500,function(){var j=b("#saveEventButton");var i=b("#cancelEventButton");j.removeAttr("disabled").show(250);i.removeAttr("disabled").show(250);g.remove()})})};a.resetEventView=function(){var h=b("#eventDetails");var f=b(".event-editable");var d=b("#newEventButton");var g=b("#deleteEventButton");var j=b("#saveEventButton");var e=b("#cancelEventButton");var i=b("#eventsSelect");d.attr("disabled","disabled");g.attr("disabled","disabled");j.attr("disabled","disabled").hide();e.attr("disabled","disabled").hide();b("#Event_notes_edit").off("click");b("#Event_description_edit").off("click");if(f.length>0){f.each(function(){b(this).editable("destroy")})}h.fadeOut(500,function(){h.empty();h.fadeIn(500,function(){d.removeAttr("disabled");i.removeAttr("disabled")})})};a.loadEvent=function(h){var e=b("#newEventButton");var g=b("#deleteEventButton");var j=b("#saveEventButton");var f=b("#cancelEventButton");var i=b("#eventsSelect");var k='<div id="loading"><img src="'+utilities.urls.base+'/images/spinners/ajax-loader.gif" alt="Loading..." /></div>';e.attr("disabled","disabled");g.attr("disabled","disabled");j.attr("disabled","disabled").hide();f.attr("disabled","disabled").hide();i.attr("disabled","disabled");i.parent().append(k);var d={id:h,aid:a.params.aid,output:"json"};b.ajax({url:a.endpoints.event.viewRecord,data:d,type:"GET",dataType:"json",success:function(l,m,n){if(l.error&&l.error==="LOGIN_REQUIRED"){i.removeAttr("disabled");e.removeAttr("disabled");g.removeAttr("disabled");i.parent().find("#loading").remove();window.setTimeout(function(){i.removeAttr("disabled");e.removeAttr("disabled");g.removeAttr("disabled");utilities.ajaxError.show("Error","Failed to load the event",n,"error","Login Required")},1000);return}d.output="html";if(l.data&&l.data.id!=="undefined"){a.setupEventView(l.data,d)}},error:function(n,l,m){i.removeAttr("disabled");e.removeAttr("disabled");g.removeAttr("disabled");i.parent().find("#loading").remove();utilities.ajaxError.show("Error","Failed to load the event",n,l,m)}})}}(window.eventManagementView=window.eventManagementView||{},jQuery));