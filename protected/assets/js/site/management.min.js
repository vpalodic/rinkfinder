(function(a,b,c){a.endpoints={counts:"/server/endpoint",details:"/server/endpoint",operations:"/server/endpoint"};a.intervalId=false;a.dialogBox="";a.editDialogBox="";a.mainContainer="";a.fromDate=moment().subtract("days",29);a.toDate=moment().add("days",29);a.isLoading=false;a.processCounts=function(d,f,h){if(f!=="success"||d.success!==true){return false}var e;var g=d.model;for(e in g){switch(e){case"arenas":this.processCount(e,g.arenas);break;case"contacts":this.processCount(e,g.contacts);break;case"locations":this.processCount(e,g.locations);break;case"events":this.processCount(e,g.events);break;case"requests":this.processCount(e,g.requests);break;case"reservations":this.processCount(e,g.reservations);break}}};a.createBadge=function(e,f){var d='<span class="badge';if(e!==""){d+=" "+e+'">'}else{d+='">'}d+=f+"</span>";return d};a.processCount=function(e,h){var d=b("#"+e+"Header");var n=b("#"+e+"Well");var p=b("#"+e+"Badge");var q='<a href="#" ';var k='<i class="fa fa-list fa-lg"></i> '+e.capitalize();p.empty();q+='id="'+e+'BadgeLink" class="btn btn-info">';q+=a.createBadge("badge-info",h.total)+"</a>";b(q).appendTo(p);p.off("click","#"+e+"BadgeLink");p.on("click","#"+e+"BadgeLink",[h,e],function(i){i.preventDefault();a.handleBadgeClick(i.data[0].endpoint,i.data[1].capitalize()+":")});d.empty();d.html(k);var l=0;var g=0;var f=null;var o=null;var m=[];k="";if(h.hasOwnProperty("type")){k='<ul id="'+e+'UnorderedList" class="unstyled" style="padding: 0px 0px;margin: 0px 0px">';for(l=0;l<h.type.length;l++){f=h.type[l];if(f.count<=0){continue}m.push(["#"+e+"Type"+f.id+"BadgeLink",f.endpoint,e.capitalize()+": "+f.display_name]);q='<a href="#" id="'+e+"Type"+f.id+'BadgeLink" class="btn btn-success btn-block">';q+=a.createBadge("badge-success",f.count);k+='<li data-name="'+f.name+'" data-id='+f.id+" data-count="+f.count+' data-display_name="'+f.display_name+'" data-display_order='+f.display_order+' rel="tooltip" title="'+f.description+'" style="word-break:break-all;word-wrap:break-word;padding: 5px 5px;margin: 0px 0px;">'+q+" <strong>"+f.display_name+"</strong></a>";if(f.hasOwnProperty("status")){k+='<ul class="inline" style="padding: 5px 5px;">';for(g=0;g<f.status.length;g++){o=f.status[g];if(o.count<=0){continue}m.push(["#"+e+"Type"+f.id+"Status"+o.id+"BadgeLink",o.endpoint,e.capitalize()+": "+f.display_name+" - "+o.display_name]);q='<a href="#" class="btn btn-warning" id="'+e+"Type"+f.id+"Status"+o.id+'BadgeLink">';q+=a.createBadge("badge-warning",o.count);k+='<li data-name="'+o.name+'" data-id='+o.id+" data-count="+o.count+' data-display_name="'+o.display_name+'" data-display_order='+o.display_order+'rel="tooltip" title="'+o.description+'" style="word-break:break-all;word-wrap:break-word;padding: 5px 5px;margin: 0px 0px;">'+q+" <strong>"+o.display_name+"</strong></li></a>"}k+="</ul></li>"}else{k+="</li>"}}k+="</ul>"}else{if(h.hasOwnProperty("status")){k='<ul id="'+e+'UnorderedList" class="unstyled" style="padding: 5px 5px;">';for(l=0;l<h.status.length;l++){o=h.status[l];if(o.count<=0){continue}m.push(["#"+e+"Status"+o.id+"BadgeLink",o.endpoint,e.capitalize()+": "+o.display_name]);q='<a href="#" class="btn btn-success btn-block" id="'+e+"Status"+o.id+'BadgeLink">';q+=a.createBadge("badge-success",o.count);k+='<li data-name="'+o.name+'" data-id='+o.id+" data-count="+o.count+' data-display_name="'+o.display_name+'" data-display_order='+o.display_order+'rel="tooltip" title="'+o.description+'" style="word-break:break-all;word-wrap:break-word;padding: 5px 5px;">'+q+" <strong>"+o.display_name+"</strong></a>";if(o.hasOwnProperty("type")){k+='<ul class="inline" style="padding: 5px 5px;">';for(g=0;g<o.type.length;g++){f=o.type[g];if(f.count<=0){continue}m.push(["#"+e+"Status"+o.id+"Type"+f.id+"BadgeLink",f.endpoint,e.capitalize()+": "+o.display_name+" - "+f.display_name]);q='<a href="#" class="btn btn-warning" id="'+e+"Status"+o.id+"Type"+f.id+'BadgeLink">';q+=a.createBadge("badge-warning",f.count);k+='<li data-name="'+f.name+'" data-id='+f.id+" data-count="+f.count+' data-display_name="'+f.display_name+'" data-display_order='+f.display_order+'rel="tooltip" title="'+f.description+'" style="word-break:break-all;word-wrap:break-word;padding: 5px 5px;">'+q+" <strong>"+f.display_name+"</strong></a></li>"}k+="</ul></li>"}else{k+="</li>"}}k+="</ul>"}}n.empty();n.html(k);for(l=0;l<m.length;l++){n.off("click",m[l][0]);n.on("click",m[l][0],[m[l][1],m[l][2]],function(i){i.preventDefault();a.handleBadgeClick(i.data[0],i.data[1])})}};a.getAll=function(){if(this.isLoading){return}this.isLoading=true;var e=this;var d=b("i.fa-refresh");d.toggleClass("fa-spin");b.ajax({url:e.endpoints.counts,type:"GET",dataType:"json",data:{model:["events","requests","arenas","contacts"],from:a.fromDate.format("YYYY-MM-DD"),to:a.toDate.format("YYYY-MM-DD")},success:function(f,g,h){if(f.success===false){d.toggleClass("fa-spin");utilities.ajaxError.show("Management Dashboard","Failed to retrieve dashboard counts",h,g,"Login Required");return}e.processCounts(f,g,h);window.setTimeout(function(){d.toggleClass("fa-spin");e.isLoading=false},1000)},error:function(h,f,g){utilities.ajaxError.show("Management Dashboard","Failed to retrieve dashboard counts",h,f,g);d.toggleClass("fa-spin");e.isLoading=false}});return true};a.getEvents=function(){if(this.isLoading){return}this.isLoading=true;var e=this;var d=b("#reportrangeRefreshButton i");d.toggleClass("fa-spin");if(a.intervalId!==false){window.clearInterval(a.intervalId);a.intervalId=false}b.ajax({url:e.endpoints.counts,type:"GET",dataType:"json",data:{model:["events"],from:a.fromDate.format("YYYY-MM-DD"),to:a.toDate.format("YYYY-MM-DD")},success:function(f,g,h){if(f.success===false){d.toggleClass("fa-spin");utilities.ajaxError.show("Management Dashboard","Failed to retrieve dashboard counts",h,g,"Login Required");return}e.processCounts(f,g,h);window.setTimeout(function(){d.toggleClass("fa-spin");e.isLoading=false;if(a.intervalId===false){a.intervalId=window.setInterval(function(){a.getAll()},900000)}},1000)},error:function(h,f,g){utilities.ajaxError.show("Management Dashboard","Failed to retrieve dashboard counts",h,f,g);d.toggleClass("fa-spin");e.isLoading=false;if(a.intervalId===false){a.intervalId=window.setInterval(function(){a.getAll()},900000)}}});return true};a.getRequests=function(){if(this.isLoading){return}this.isLoading=true;var e=this;var d=b("#refreshRequestsButton i");d.toggleClass("fa-spin");if(a.intervalId!==false){window.clearInterval(a.intervalId);a.intervalId=false}b.ajax({url:e.endpoints.counts,type:"GET",dataType:"json",data:{model:["requests"]},success:function(f,g,h){if(f.success===false){d.toggleClass("fa-spin");utilities.ajaxError.show("Management Dashboard","Failed to retrieve dashboard counts",h,g,"Login Required");return}e.processCounts(f,g,h);window.setTimeout(function(){d.toggleClass("fa-spin");e.isLoading=false;if(a.intervalId===false){a.intervalId=window.setInterval(function(){a.getAll()},900000)}},1000)},error:function(h,f,g){utilities.ajaxError.show("Management Dashboard","Failed to retrieve dashboard counts",h,f,g);d.toggleClass("fa-spin");e.isLoading=false;if(a.intervalId===false){a.intervalId=window.setInterval(function(){a.getAll()},900000)}}});return true};a.getArenas=function(){if(this.isLoading){return}this.isLoading=true;var e=this;var d=b("#refreshArenasButton i");d.toggleClass("fa-spin");if(a.intervalId!==false){window.clearInterval(a.intervalId);a.intervalId=false}b.ajax({url:e.endpoints.counts,type:"GET",dataType:"json",data:{model:["arenas"]},success:function(f,g,h){if(f.success===false){d.toggleClass("fa-spin");utilities.ajaxError.show("Management Dashboard","Failed to retrieve dashboard counts",h,g,"Login Required");return}e.processCounts(f,g,h);window.setTimeout(function(){d.toggleClass("fa-spin");e.isLoading=false;if(a.intervalId===false){a.intervalId=window.setInterval(function(){a.getAll()},900000)}},1000)},error:function(h,f,g){utilities.ajaxError.show("Management Dashboard","Failed to retrieve dashboard counts",h,f,g);d.toggleClass("fa-spin");e.isLoading=false;if(a.intervalId===false){a.intervalId=window.setInterval(function(){a.getAll()},900000)}}});return true};a.getContacts=function(){if(this.isLoading){return}this.isLoading=true;var e=this;var d=b("#refreshContactsButton i");d.toggleClass("fa-spin");if(a.intervalId!==false){window.clearInterval(a.intervalId);a.intervalId=false}b.ajax({url:e.endpoints.counts,type:"GET",dataType:"json",data:{model:["contacts"]},success:function(f,g,h){if(f.success===false){d.toggleClass("fa-spin");utilities.ajaxError.show("Management Dashboard","Failed to retrieve dashboard counts",h,g,"Login Required");return}e.processCounts(f,g,h);window.setTimeout(function(){d.toggleClass("fa-spin");e.isLoading=false;if(a.intervalId===false){a.intervalId=window.setInterval(function(){a.getAll()},900000)}},1000)},error:function(h,f,g){utilities.ajaxError.show("Management Dashboard","Failed to retrieve dashboard counts",h,f,g);d.toggleClass("fa-spin");e.isLoading=false;if(a.intervalId===false){a.intervalId=window.setInterval(function(){a.getAll()},900000)}}});return true};a.handleBadgeClick=function(f,e){var d=utilities.modal.add(e,"",false,false,true);d.modal({loading:true,replace:true,modalOverflow:true});a.getModalData(d,f);return false};a.getModalData=function(f,e,d){var g=this;var h=f;b.ajax({url:e,type:"GET",dataType:"html",data:{output:"html"},success:function(i,j,l){var m=false;try{m=JSON.parse(i)}catch(k){m=false}if(m!==false){window.setTimeout(function(){h.modal("loading");h.find(".modal-body").empty().append('<h1 class="text-error">Error</h1>');utilities.ajaxError.show("Management Dashboard","Failed to retrieve data",l,"error","Login Required")},1000);return}window.setTimeout(function(){h.find(".modal-body").empty().append(g.processModalData(i,j,l));h.modal("loading")},1000)},error:function(k,i,j){window.setTimeout(function(){h.modal("loading");h.find(".modal-body").empty().append('<h1 class="text-error">Error</h1>');utilities.ajaxError.show("Management Dashboard","Failed to retrieve data",k,i,j)},1000)}});return true};a.processModalData=function(d,e,f){return d};a.doReady=function(){b("#reportrange").daterangepicker({ranges:{Today:[moment(),moment()],Yesterday:[moment().subtract("days",1),moment().subtract("days",1)],Tomorrow:[moment().add("days",1),moment().add("days",1)],"This Month":[moment().startOf("month"),moment().endOf("month")],"Last Month":[moment().subtract("month",1).startOf("month"),moment().subtract("month",1).endOf("month")],"Next Month":[moment().add("month",1).startOf("month"),moment().add("month",1).endOf("month")]},showDropdowns:true,opens:"right",startDate:moment().subtract("days",29),endDate:moment().add("days",29)},function(f,d,e){if(f&&d){b("#reportrange span").html(f.format("MMMM D, YYYY")+" - "+d.format("MMMM D, YYYY"));utilities.loadingScreen.parentId="eventsContainer";utilities.loadingScreen.containerId="eventsAccordionHeader";utilities.loadingScreen.image.enabled=true;utilities.loadingScreen.image.src="/images/spinners/ajax-loader-roller-bg_red-fg_blue.gif";a.fromDate=f;a.toDate=d;a.getEvents()}});b("#reportrangeRefreshButton").on("click",function(d){utilities.loadingScreen.parentId="eventsContainer";utilities.loadingScreen.containerId="eventsAccordionHeader";utilities.loadingScreen.image.enabled=true;utilities.loadingScreen.image.src="/images/spinners/ajax-loader-roller-bg_red-fg_blue.gif";a.getEvents()});b("#refreshRequestsButton").on("click",function(d){utilities.loadingScreen.parentId="requestsContainer";utilities.loadingScreen.containerId="requestsAccordionHeader";utilities.loadingScreen.image.enabled=true;utilities.loadingScreen.image.src="/images/spinners/ajax-loader-roller-bg_red-fg_blue.gif";a.getRequests()});b("#refreshArenasButton").on("click",function(d){utilities.loadingScreen.parentId="arenasContainer";utilities.loadingScreen.containerId="arenasAccordionHeader";utilities.loadingScreen.image.enabled=true;utilities.loadingScreen.image.src="/images/spinners/ajax-loader-roller-bg_red-fg_blue.gif";a.getArenas()});b("#refreshContactsButton").on("click",function(d){utilities.loadingScreen.parentId="contactsContainer";utilities.loadingScreen.containerId="contactsAccordionHeader";utilities.loadingScreen.image.enabled=true;utilities.loadingScreen.image.src="/images/spinners/ajax-loader-roller-bg_red-fg_blue.gif";a.getContacts()});a.intervalId=window.setInterval(function(){a.getAll()},900000)}}(window.management=window.management||{},jQuery));